<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<title>全球海缆走线示意</title>
	<!-- 避免 favicon.ico 404 -->
	<link rel="icon"
		href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' ry='12' fill='%230b1220'/%3E%3Cpath d='M12 32c0-10.5 9-18 20-18s20 7.5 20 18-9 18-20 18-20-7.5-20-18z' fill='%2348dbfb' fill-opacity='.65'/%3E%3Cpath d='M20 32c0-6 5.5-10 12-10s12 4 12 10-5.5 10-12 10-12-4-12-10z' fill='%23ffd666' fill-opacity='.9'/%3E%3C/svg%3E" />
	<!-- Element UI 样式（用于图标）-->
	<link rel="stylesheet" href="node_modules/element-ui/lib/theme-chalk/index.css">
	<!-- 核心 JavaScript 库（阻塞加载，必须优先） -->
	<script src="node_modules/vue/dist/vue.min.js"></script>
	<script src="node_modules/element-ui/lib/index.js"></script>
	<script src="node_modules/echarts/dist/echarts.min.js"></script>
	<script src="node_modules/echarts-gl/dist/echarts-gl.min.js"></script>
	<!-- 权益海缆数据 -->
	<script src="seacable_data/quanyi.js"></script>

	<!-- 数据文件（可延迟加载） -->
	<!-- 英文版世界地图 -->
	<!-- <script src="js/world.js"></script> -->
	<!-- 汉化版标准世界地图 -->
	<!-- <script src="js/worldZH.js"></script> -->
	<!-- 以亚太为中心的英文版世界地图 -->
	<!-- 数据文件（可延迟加载） -->
	<script src="js/worldZH-china-center.js"></script>
	<!-- 所有样式代码都在这 -->
	<link rel="stylesheet" href="css/app.css">
</head>

<body>
	<div id="app">
		<div class="screen" :class="{ 'is-compact': isCompactMode, 'fullscreen-active': isMapFullscreen }" :style="!isCompactMode ? { gridTemplateColumns: leftColPct + '%' + ' ' + centerColPct + '%' + ' ' + rightColPct + '%' } : {}">
			<!-- 左：操作控制台（大屏模式） --> 
			<section class="panel left console-slim" v-if="!isCompactMode">
				<div class="panel-header"><span class="accent"></span>{{ t('操作控制台') }}
					<button class="inline-btn" style="float:right" @click.stop="resetAllFilters">{{ t('全部重置') }}</button>
					<button class="inline-btn" style="float:right; margin-right:6px;" @click.stop="restartApp"><i class="el-icon-switch-button" aria-hidden="true" style="margin-right:4px;"></i>{{ t('重启') }}</button>
				</div>
				<div class="panel-body custom-scroll-hidden">
					<!-- 概览面板：中国移动海陆缆整体情况 -->
					<div class="overview">
						<div class="title sci-title">
							<svg class="sci-icon" width="28" height="28" viewBox="0 0 28 28" style="margin-right:8px;">
								<defs>
									<radialGradient id="sciG" cx="50%" cy="50%" r="60%">
										<stop offset="0%" stop-color="#48dbfb" />
										<stop offset="100%" stop-color="#165DFF" />
									</radialGradient>
								</defs>
								<circle cx="14" cy="14" r="12" fill="url(#sciG)" opacity="0.7" />
								<circle cx="14" cy="14" r="7" fill="#fff" opacity="0.18" />
							</svg>
							<span class="sci-text">{{ t('中国移动海陆缆整体情况') }}</span>
						</div>
						<div class="metrics">
							<div class="metric">
								<div class="label">{{ t('权益') }}</div>
								<div class="value">{{ formatG(overviewDisplayMetrics.equityTotal) }}</div>
							</div>
							<div class="metric">
								<div class="label">{{ t('点亮') }}</div>
								<div class="value">{{ formatG(overviewDisplayMetrics.lightUpBandwidthTotal) }}</div>
							</div>
							<div class="metric">
								<div class="label">{{ t('已用') }}</div>
								<div class="value">{{ formatG(overviewDisplayMetrics.usingBandwidthTotal) }}</div>
							</div>
							<div class="metric">
								<div class="label">{{ t('海陆缆总长') }}</div>
								<div class="value">{{ formatKm(overviewDisplayMetrics.lengthTotal) }}</div>
							</div>
							<div class="metric">
								<div class="label">{{ t('利用率') }}</div>
								<div class="value">{{ formatPercent(overviewDisplayMetrics.utilizationRateTotal) }}</div>
							</div>
							<div class="metric">
								<div class="label">{{ t('业务总数') }}</div>
								<div class="value">{{ formatInt(overviewDisplayMetrics.businessesTotal) }}</div>
							</div>
						</div>
						<div class="regions">
							<label class="chip">
								<input type="radio" name="overviewRegion" value="默认" v-model="overviewRegion"> {{ t('全部') }}
							</label>
							<label class="chip" v-for="r in ['美国','欧洲','亚太','澳洲','其他']" :key="r">
								<input type="radio" name="overviewRegion" :value="r" v-model="overviewRegion"> {{ t(r) }}
							</label>
						</div>
					</div>
					<div class="controls">
						<div class="block">
							<div style="display:flex; align-items:center; justify-content:space-between; gap:8px;">
								<h3>{{ t('筛选') }}
									<label class="inline-btn"
										style="margin-left:10px; display:inline-flex; align-items:center; gap:6px;">
										<input type="checkbox" v-model="showCables" @change="updateChart"> {{ t('海缆') }}
									</label>
									<label class="inline-btn"
										style="margin-left:6px; display:inline-flex; align-items:center; gap:6px;">
										<input type="checkbox" v-model="showLandings" @change="updateChart"> {{ t('登陆站') }}
									</label>
								</h3>
								<div style="display:flex; gap:6px;">
									<button class="inline-btn" @click.stop="selectAllOwnerships">{{ t('权益全选') }}</button>
									<button class="inline-btn" @click.stop="selectAllTypes">{{ t('类型全选') }}</button>
								</div>
							</div>
							<div class="filters" style="margin-top:6px;">
								<label class="ownership-self">
									<input type="checkbox" value="自建" v-model="selectedOwnerships"> {{ t('自建') }}
									<span class="only-btn" @click.stop.prevent="selectOnlyOwnership('自建')">{{ t('只选') }}</span>
								</label>
								<label class="ownership-co">
									<input type="checkbox" value="合建" v-model="selectedOwnerships"> {{ t('合建') }}
									<span class="only-btn" @click.stop.prevent="selectOnlyOwnership('合建')">{{ t('只选') }}</span>
								</label>
								<label class="ownership-rent">
									<input type="checkbox" value="租用" v-model="selectedOwnerships"> {{ t('租用') }}
									<span class="only-btn" @click.stop.prevent="selectOnlyOwnership('租用')">{{ t('只选') }}</span>
								</label>
								<label class="ownership-none">
									<input type="checkbox" value="非权益" v-model="selectedOwnerships"> {{ t('非权益') }}
									<span class="only-btn" @click.stop.prevent="selectOnlyOwnership('非权益')">{{ t('只选') }}</span>
								</label>

								<label><input type="checkbox" value="跨太平洋" v-model="selectedTypes"> {{ t('跨太平洋') }} <span
										class="only-btn" @click.stop.prevent="selectOnlyType('跨太平洋')">{{ t('只选') }}</span></label>
								<label><input type="checkbox" value="亚欧互联" v-model="selectedTypes"> {{ t('亚欧互联') }} <span
										class="only-btn" @click.stop.prevent="selectOnlyType('亚欧互联')">{{ t('只选') }}</span></label>
								<label><input type="checkbox" value="区域互联" v-model="selectedTypes"> {{ t('区域互联') }} <span
										class="only-btn" @click.stop.prevent="selectOnlyType('区域互联')">{{ t('只选') }}</span></label>
								<label><input type="checkbox" value="其他" v-model="selectedTypes"> {{ t('其他') }} <span
										class="only-btn" @click.stop.prevent="selectOnlyType('其他')">{{ t('只选') }}</span></label>
							</div>
							<div class="filters range" style="margin-top:8px;">
								<label>{{ t('洲别') }}
									<select v-model="scopeContinent">
										<option value="all">{{ t('全部') }}</option>
										<option value="APAC">{{ t('亚太') }}</option>
										<option value="EMEA">{{ t('欧洲中东非') }}</option>
										<option value="AMER">{{ t('美洲') }}</option>
									</select>
								</label>
								<label>{{ t('距离') }}
									<select v-model="scopeDistance">
										<option value="all">{{ t('不限') }}</option>
										<option value=">5000">{{ t('大于 5000km') }}</option>
										<option value="<5000">{{ t('小于 5000km') }}</option>
									</select>
								</label>
							</div>
						</div>
					</div>
					<div class="title stats-title"><span class="accent"></span>{{ t('中国移动海缆整体情况') }}</div>
					<div class="console-stats">
						<div class="stat stat-hero">
							<div class="stat-row">
								<div class="stat-left">
									<div class="stat-head">
										<span class="stat-chip pulse">{{ t('实时') }}</span>
										<span class="stat-title">{{ t('全网海缆') }}</span>
									</div>
									<div class="stat-subline">{{ t('运行中') }} {{ stats.okCount }} ｜ {{ t('故障') }} <span class="stat-fault">{{ faultCount }}</span></div>
								</div>
								<div class="stat-right">
									<div class="stat-number">{{ stats.totalCables }}</div>
								</div>
							</div>
						</div>
						<div class="stat">
							<div class="stat-row">
								<div class="stat-left">
									<div class="stat-head">
										<span class="stat-chip">{{ t('覆盖') }}</span>
										<span class="stat-title">{{ t('登陆站') }}</span>
									</div>
									<div class="stat-subline">{{ t('权益') }} {{ stats.ownedLandings }}</div>
								</div>
								<div class="stat-right">
									<div class="stat-number">{{ stats.totalLandings }}</div>
								</div>
							</div>
						</div>
						<div class="stat">
							<div class="stat-row">
								<div class="stat-left">
									<div class="stat-head">
										<span class="stat-chip ghost">{{ t('资产') }}</span>
										<span class="stat-title">{{ t('权益海缆') }}</span>
									</div>
									<div class="stat-grid">
										<span>{{ t('自建') }} {{ stats.selfCables }}</span>
										<span>{{ t('合建') }} {{ stats.coCables }}</span>
										<span>{{ t('租用') }} {{ stats.rentCables }}</span>
									</div>
								</div>
								<div class="stat-right">
									<div class="stat-number">{{ stats.ownedCables }}</div>
								</div>
							</div>
						</div>
						<div class="stat">
							<div class="stat-row">
								<div class="stat-left">
									<div class="stat-head">
										<span class="stat-chip ghost">{{ t('节点') }}</span>
										<span class="stat-title">{{ t('权益登陆站') }}</span>
									</div>
									<div class="stat-subline muted">{{ t('包含自建 / 合建 / 租用') }}</div>
								</div>
								<div class="stat-right">
									<div class="stat-number">{{ stats.ownedLandings }}</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>

			<!-- 全局 Tooltip 容器（紧凑/大屏通用） -->
			<div v-if="faultTooltip.show" ref="faultTooltip" class="tooltip-box fault-tooltip" :style="{ left: faultTooltip.left + 'px', top: faultTooltip.top + 'px' }">
				<div class="title">
					<span class="pill" :style="typeThemeStyle('cable')">{{ t('故障') }}</span>
					<span>{{ faultTitle(faultTooltip.fault) }}</span>
				</div>
				<div class="fault-tooltip-body">
					<div class="fault-loc-list">
						<template v-if="faultTooltipCables(faultTooltip.fault).length">
							<div class="loc-card" v-for="(loc, idx) in faultTooltipCables(faultTooltip.fault)" :key="idx">
								<div class="loc-head">
									<span class="pill danger-pill">{{ t('故障定位') }} {{ idx + 1 }}</span>
									<span class="loc-name">{{ safeVal(loc.cable) }}</span>
								</div>
								<div class="loc-meta">
									<span class="chip">{{ t('登陆站') }}：{{ loc.landing || t('未填站点') }}</span>
									<span class="chip">{{ t('距离') }}：{{ loc.distance || '--' }} km</span>
								</div>
							</div>
						</template>
						<div v-else class="empty">{{ t('暂未故障定点') }}</div>
					</div>
					<div class="fault-info-list">
						<div class="row"><div class="key">{{ t('工单号') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.workOrder) }}</div></div>
						<div class="row"><div class="key">{{ t('开始时间') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.start) }}</div></div>
						<div class="row"><div class="key">{{ t('结束时间') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.end) }}</div></div>
						<div class="row"><div class="key">{{ t('故障原因') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.cause) }}</div></div>
						<div class="row"><div class="key">{{ t('处理进展') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.progress) }}</div></div>
						<div class="row"><div class="key">{{ t('业务影响') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.impact) }}</div></div>
						<div class="row"><div class="key">{{ t('备注') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.remark) }}</div></div>
						<div class="row"><div class="key">{{ t('是否重大') }}</div><div class="val">{{ safeVal(faultTooltip.fault?.isMajor) }}</div></div>
					</div>
				</div>
			</div>

			<div v-if="landingTooltip.show" ref="landingTooltip" class="tooltip-box"
				:style="[{ left: landingTooltip.left + 'px', top: landingTooltip.top + 'px' }, tooltipThemeStyle('landing', landingTooltip.lp)]">
				<div class="title">
					<span class="pill" :style="pillThemeStyle('landing', landingTooltip.lp)">{{ t('登陆站') }}</span>
					<span>{{ normalizeText(landingTooltip.lp?.name || t('登陆站')) }}</span>
					<span class="pill" v-if="landingTooltip.lp?.country || landingTooltip.detail?.country">{{
						translateCountryToZh(normalizeText(landingTooltip.lp?.country || landingTooltip.detail?.country)) }}</span>
				</div>
				<div class="row"><div class="key">{{ t('经纬度') }}</div><div class="val"><span v-if="landingTooltip.lp?.coords && landingTooltip.lp.coords.length >= 2">Lon {{ Number(landingTooltip.lp.coords[0]).toFixed(2) }}, Lat {{ Number(landingTooltip.lp.coords[1]).toFixed(2) }}</span><span v-else>-</span></div></div>
				<div class="row"><div class="key">{{ t('局向') }}</div><div class="val">{{ displayDirection(landingTooltip.lp?.direction || landingTooltip.detail?.direction) }}</div></div>
				<div class="row"><div class="key">{{ t('洲别') }}</div><div class="val">{{ displayContinents(landingTooltip.lp?.continent || landingTooltip.detail?.continent || landingTooltip.lp?.continentMacro || landingTooltip.detail?.continentMacro) || displayMacroRegion(landingTooltip.lp?.continent || landingTooltip.detail?.continent || landingTooltip.lp?.continentMacro || landingTooltip.detail?.continentMacro) || '-' }}</div></div>
				<div class="row"><div class="key">{{ t('关联海缆') }}</div><div class="val"><strong>{{ landingTooltip.detail?.cables?.length || 0 }}</strong> {{ t('条') }}</div></div>
				<div class="tooltip-list" v-if="tooltipLandingCables.length">
					<label class="chip" v-for="(cb, idx) in tooltipLandingCables" :key="cb.id || idx" @click.stop>
						<input type="checkbox" v-model="landingTooltip.selectedCableIds" :value="cb.id || cb.name" style="margin-right:6px;">
						<span class="name" @click.stop="focusCableByRef(cb)">{{ cb.name }}</span>
						<span class="meta">{{ cb.rfs_year || '-' }}<span class="planned" v-if="cb.is_planned" style="margin-left:6px;">{{ t('规划中') }}</span></span>
					</label>
				</div>
			</div>

			<div v-if="cableTooltip.show" ref="cableTooltip" class="tooltip-box"
				:style="[{ left: cableTooltip.left + 'px', top: cableTooltip.top + 'px' }, tooltipThemeStyle('cable', cableTooltip.line)]">
				<div class="title">
					<span class="pill" :style="typeThemeStyle('cable')">{{ t('海缆') }}</span>
					<span>{{ cableTooltip.line?.name || t('海缆') }}</span>
					<span class="pill" :class="cableTooltip.line?.ownershipClass" v-if="cableTooltip.line?.ownership">{{ t(cableTooltip.line?.ownership) }}</span>
				</div>
				<div class="row"><div class="key">{{ t('长度') }}</div><div class="val">{{ cableTooltip.detail?.length || '-' }}</div></div>
				<div class="row"><div class="key">{{ t('直线距离') }}</div><div class="val">{{ cableTooltip.line?.km || 0 }} km</div></div>
				<div class="row"><div class="key">{{ t('商用年') }}</div><div class="val">{{ cableTooltip.detail?.rfs_year || '-' }}</div></div>
				<div class="row"><div class="key">{{ t('局向') }}</div><div class="val">{{ displayDirection(cableTooltip.line?.direction || cableTooltip.detail?.direction) }}</div></div>
				<div class="row"><div class="key">{{ t('洲别') }}</div><div class="val">{{ displayContinents(cableTooltip.line?.continents || cableTooltip.detail?.continents || cableTooltip.line?.continent || cableTooltip.detail?.continent) || displayMacroRegion(cableTooltip.line?.continent || cableTooltip.detail?.continent) || '-' }}</div></div>
				<div class="row"><div class="key">{{ t('登陆点') }}</div><div class="val"><strong>{{ landingCount(cableTooltip.detail || cableDetail.detail) }}</strong> {{ t('个') }}</div></div>
			</div>

			<!-- 中：世界地图 -->
			<section class="panel center" :class="{ fullscreen: isMapFullscreen }">
				<div class="panel-body">
					<!-- 标题图片叠层（不阻挡交互） -->
					<div class="map-title-overlay" aria-hidden="true">
						<img :src="currentTitleBgUrl" alt="title banner" loading="lazy" />
						<div class="title-text">{{ t('全球海缆运行状态总览') }}</div>
					</div>
					<!-- 地图工具：收拢为 Speed Dial -->
					<div class="map-actions dial" :class="{ open: mapDialOpen }">
						<div class="dial-main">
							<button v-if="!faultEditState.picking && isGlobe" class="fab primary" @click="switchTo2DNormalFromGlobe" :disabled="modeSwitching" :title="t('切换至普通 2D 地图')">
								<i class="el-icon-map-location"></i>
								<span>{{ t('普通2D') }}</span>
							</button>
							<button v-if="!faultEditState.picking && isGlobe" class="fab ghost" @click="switchToTilesFromGlobe" :disabled="modeSwitching" :title="t('切换至 2D 瓦片地图')">
								<i class="el-icon-picture-outline"></i>
								<span>{{ t('瓦片2D') }}</span>
							</button>
							<button v-else class="fab primary" @click="toggleGlobe" :disabled="modeSwitching" v-if="!faultEditState.picking">
								<i class="el-icon-map-location"></i>
								<span>{{ isGlobe ? t('平面') : '3D' }}</span>
							</button>
							<button v-if="!faultEditState.picking && !isGlobe" class="fab ghost" :disabled="modeSwitching" @click="toggleTileMapVersionQuick" :title="t('在 2D 普通/瓦片之间一键切换')">
								<i class="el-icon-picture-outline"></i>
								<span>{{ mapVersion === 'tiles' ? t('普通2D') : t('瓦片2D') }}</span>
							</button>
							<button v-if="!faultEditState.picking" class="fab ghost" :disabled="modeSwitching" @click="toggleFullscreen">
								<i class="el-icon-full-screen"></i>
								<span>{{ isMapFullscreen ? t('退出') : t('全屏') }}</span>
							</button>
							<button v-if="!faultEditState.picking && isGlobe && focusMode !== 'none' && focusTargetCoord" class="fab ghost" :disabled="modeSwitching" @click="centerFocus">
								<i class="el-icon-location-outline"></i>
								<span>{{ t('居中焦点') }}</span>
							</button>
							<button v-if="focusMode !== 'none'" class="fab ghost" :disabled="modeSwitching" @click="clearFocus">
								<i class="el-icon-close"></i>
								<span>{{ t('退出聚焦') }}</span>
							</button>
							<button v-if="!faultEditState.picking && liveScenarioMode" class="fab ghost" :disabled="modeSwitching" @click="stopLiveScenarioQuick" :title="t('退出当前实况模式')">
								<i class="el-icon-switch-button"></i>
								<span>{{ t('关闭实况') }}</span>
							</button>
							<button v-if="!faultEditState.picking" class="fab toggle" @click="toggleMapDial" :aria-pressed="mapDialOpen">
								<i :class="mapDialOpen ? 'el-icon-close' : 'el-icon-menu'" ></i>
								<span>{{ t('工具') }}</span>
							</button>
						</div>
						<div class="dial-panel" :class="{ 'single-column': isGlobe && focusMode !== 'none' }" v-show="mapDialOpen">
							<div class="dial-section">
								<div class="dial-section-title">{{ t('模式 / 布局') }}</div>
								<div class="dial-grid">
									<button class="btn hero" :class="{ 'is-loading': modeSwitching }" :disabled="modeSwitching" @click="toggleCompactMode" :title="t('双布局切换：紧凑模式提升信息密度与操作效率，默认首次加载。')"><i class="el-icon-monitor" style="margin-right:4px;"></i>{{ isCompactMode ? t('大屏模式') : t('紧凑模式') }}
										<el-tooltip effect="dark" placement="top" :content="t('紧凑模式：提升信息密度与操作效率，适配小屏；大屏模式：更适合展示。')">
											<i class="el-icon-info" aria-hidden="true" style="margin-left:6px;"></i>
										</el-tooltip>
									</button>
									<button class="btn ghost" :disabled="modeSwitching" @click="resetLayout"><i class="el-icon-refresh" style="margin-right:4px;"></i>{{ t('重置布局') }}</button>
									<button class="btn ghost" :disabled="modeSwitching" @click="resetView"><i class="el-icon-refresh-left" style="margin-right:4px;"></i>{{ t('复位视角') }}</button>
									<button class="btn ghost" :disabled="modeSwitching" @click="restartApp"><i class="el-icon-switch-button" style="margin-right:4px;"></i>{{ t('重启') }}</button>
									<button class="btn hero" :disabled="modeSwitching" @click="openAgent" :title="t('Agent 入口')"><i class="el-icon-chat-line-round" style="margin-right:4px;"></i>Agent（{{ t('敬请期待') }}）</button>
								</div>
							</div>
							<div class="dial-section">
								<div class="dial-section-title">{{ t('实况 / 展示') }}</div>
								<div class="dial-grid live-grid">
									<button
										class="btn live"
										:class="{ 'is-loading': liveScenarioRunning && liveScenarioMode === 'pc', active: liveScenarioMode === 'pc' }"
										:disabled="modeSwitching || (liveScenarioRunning && liveScenarioMode !== 'pc')"
										@click="liveScenarioMode === 'pc' ? stopPcLiveMode() : startPcLiveMode()">
										<i :class="liveScenarioMode === 'pc' ? 'el-icon-switch-button' : 'el-icon-s-promotion'" style="margin-right:4px;"></i>
										{{ liveScenarioMode === 'pc' ? t('停止 PC 实况模式') : t('开启 PC 实况模式') }}
									</button>
									<button
										class="btn live"
										:class="{ 'is-loading': liveScenarioRunning && liveScenarioMode === 'big-screen', active: liveScenarioMode === 'big-screen' }"
										:disabled="modeSwitching || (liveScenarioRunning && liveScenarioMode !== 'big-screen')"
										@click="liveScenarioMode === 'big-screen' ? stopBigScreenLiveMode() : startBigScreenLiveMode()">
										<i :class="liveScenarioMode === 'big-screen' ? 'el-icon-switch-button' : 'el-icon-monitor'" style="margin-right:4px;"></i>
										{{ liveScenarioMode === 'big-screen' ? t('停止大屏实况模式') : t('开启大屏实况模式') }}
									</button>
									<button class="btn ghost" :disabled="modeSwitching" @click="toggleShowLandingLabels()"><i class="el-icon-view" style="margin-right:4px;"></i>{{ showLandingLabels ? t('隐藏登陆站名') : t('显示登陆站名') }}</button>
									<button v-if="isGlobe" class="btn ghost" :disabled="modeSwitching" @click="toggleAutoRotate"><i class="el-icon-refresh" style="margin-right:4px;"></i>{{ autoRotate ? t('停止自转') : t('开启自转') }}（{{ autoRotateSpeed.toFixed(1) }}×）</button>
									<label v-if="isGlobe && autoRotate" class="btn ghost auto-rotate-speed">
										<span>{{ t('自转速度') }}</span>
										<input type="range" min="0.2" max="20" step="0.1" v-model.number="autoRotateSpeed" @input="onAutoRotateSpeedChange">
										<span style="text-align:right;">{{ autoRotateSpeed.toFixed(1) }}×</span>
									</label>
									<button class="btn ghost" :disabled="modeSwitching" @click="toggleLegend"><i class="el-icon-collection" style="margin-right:4px;"></i>{{ legendVisible ? t('隐藏图例') : t('显示图例') }}</button>
								</div>
							</div>
							<div class="dial-section">
								<div class="dial-section-title"><i class="el-icon-brush" aria-hidden="true" style="margin-right:6px;"></i>{{ t(isGlobe ? '3D / 样式' : '2D / 样式') }}</div>
								<div class="dial-grid">
									<label class="btn ghost" style="display:inline-flex; align-items:center; gap:8px;">
										<span>{{ t('缩放') }}</span>
										<input type="range" min="0" max="100" v-model.number="zoomSlider" @input="onZoomSlider" style="width:170px;">
										<button class="btn ghost" style="margin-left:4px; padding:2px 6px; width: auto;" @click.stop="resetZoomSlider" :disabled="modeSwitching">{{ t('重置') }}</button>
										<button ref="zoomPopoverTrigger" class="btn ghost" style="margin-left:4px; padding:2px 6px; width: auto;" @click.stop="toggleZoomPopover" :disabled="modeSwitching">{{ t('弹出') }}</button>
									</label>
									<label v-if="isGlobe" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 220px;" :title="t('选择 3D 地形纹理（带标签）')">
										<span>{{ t('3D 地形') }}</span>
										<select v-model="currentGlobeTextureKey" @change="applyGlobeTexture(currentGlobeTextureKey)" style="min-width: 150px;">
											<option v-for="tex in globeTextureOptions" :key="tex.key" :value="tex.key">{{ t(tex.name) }}</option>
										</select>
									</label>
									<!-- 移除 2D 背景纹理下拉（与底色风格重复），保留统一的底色风格下拉 -->
									<label v-if="!isGlobe && mapVersion !== 'tiles'" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 220px;" :title="t('选择 2D 地图底色风格，兼顾紧凑/大屏与聚焦/打点/实况模式。')">
										<span>{{ t('2D 底色') }}</span>
										<select v-model="mapTextureStyle" @change="onMapTextureStyleChange(mapTextureStyle)" style="min-width: 150px;">
											<option v-for="opt in mapTextureStyleOptions" :key="opt.key" :value="opt.key">{{ t(opt.name) }}</option>
										</select>
									</label>
									<label v-if="isGlobe" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 220px;" :title="t('选择 3D 光效风格（光照/泛光/大气），并可一键关闭光效，谨慎以避免跷跷板。')">
										<span>{{ t('3D 光效') }}</span>
										<select v-model="globeGlowStyle" @change="onGlobeGlowStyleChange(globeGlowStyle)" style="min-width: 150px;">
											<option v-for="opt in globeGlowStyleOptions" :key="opt.key" :value="opt.key">{{ t(opt.name) }}</option>
										</select>
									</label>
									<label v-if="isGlobe" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 240px;" :title="t('拖动调整光效亮度，范围 0.2-2.5（默认 1.0），实时作用于光照与泛光。')">
										<span>{{ t('光效亮度') }}</span>
										<input type="range" min="0.2" max="2.5" step="0.05" v-model.number="globeGlowBrightness" @input="onGlobeGlowBrightnessChange(globeGlowBrightness)" style="width:160px;">
										<span style="min-width:42px; text-align:right;">{{ globeGlowBrightness.toFixed(2) }}</span>
										<button class="btn ghost" style="margin-left:4px; padding:2px 6px; width: auto;" @click.stop="resetGlobeGlowBrightness" :disabled="modeSwitching">{{ t('重置') }}</button>
									</label>
									<button v-if="isGlobe" class="btn ghost" :disabled="modeSwitching" @click="toggleGlobeGlow" :title="t('开关 3D 光效（bloom/大气辉光）')">
										<i class="el-icon-lightning" style="margin-right:4px;"></i>{{ globeGlowEnabled ? t('关闭光效') : t('开启光效') }}
									</button>
								</div>
							</div>
							<div class="dial-section">
								<div class="dial-section-title"><i class="el-icon-magic-stick" aria-hidden="true" style="margin-right:6px;"></i>{{ t('动画 / 特效') }}</div>
								<div class="dial-grid">
									<button class="btn ghost" :disabled="modeSwitching" @click="toggleLineEffect">
										<i class="el-icon-guide" style="margin-right:4px;"></i>{{ lineEffectEnabled ? t('关闭走线效果') : t('开启走线效果') }}
									</button>
									<button class="btn ghost" :disabled="modeSwitching" @click="toggleRippleEffect">
										<i class="el-icon-bell" style="margin-right:4px;"></i>{{ rippleEffectEnabled ? t('关闭涟漪') : t('开启涟漪') }}
									</button>
									<button class="btn ghost" :disabled="modeSwitching" @click="toggleDemoFaults" :title="t('所有接口不可用时会自动切换到演示数据，可手动开启/关闭')">
										<i :class="useDemoFaults ? 'el-icon-data-line' : 'el-icon-data-analysis'" style="margin-right:4px;"></i>{{ useDemoFaults ? t('关闭演示故障') : t('开启演示故障') }}
									</button>
								</div>
							</div>
							<div class="dial-section">
								<div class="dial-section-title"><i class="el-icon-collection-tag" aria-hidden="true" style="margin-right:6px;"></i>{{ t('数据 / 后台') }}</div>
								<div class="dial-grid">
									<label class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 180px;">
										<span>{{ t('标题背景') }}</span>
										<select v-model="currentTitleBgKey" @change="applyTitleBg(currentTitleBgKey)" style="min-width: 140px;">
											<option v-for="opt in titleBgOptions" :key="opt.key" :value="opt.key">{{ t(opt.name) }}</option>
										</select>
									</label>
									<label class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 200px;" :title="t('切换故障数据源（OA/生产网/本地），自动探测可用性，支持打点测距与聚焦联动。')">
										<span>{{ t('故障接口') }}</span>
										<el-tooltip effect="dark" placement="top" :content="t('按需切换 OA/生产网/本地接口；自动探测可用性，支持故障聚焦与打点测距联动。')">
											<i class="el-icon-info" aria-hidden="true"></i>
										</el-tooltip>
										<select v-model="faultApiMode" @change="onFaultApiModeChange" :disabled="modeSwitching" style="min-width: 140px;">
											<option v-for="mode in faultApiModes" :key="mode.key" :value="mode.key" :disabled="isFaultModeDisabled(mode.key)">{{ t(faultApiModeLabel(mode)) }}</option>
										</select>
									</label>
									<label v-if="!isGlobe" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 220px;" :title="t('通过几何重构修复 2D 地图在日期变更线（±180°经线）上的拆段，让跨洋线路连续可测，减少误差。')">
										<span>{{ t('2D 海缆重算') }}</span>
										<el-tooltip effect="dark" placement="top" :content="t('修复 2D 日期变更线拆段：跨洋线路连续可测，减少距离误差；默认加载已保存结果。')">
											<i class="el-icon-info" aria-hidden="true"></i>
										</el-tooltip>
										<select v-model="twoDRebuildMode" @change="onTwoDRebuildModeChange" :disabled="modeSwitching" style="min-width: 150px;">
											<option v-for="opt in twoDRebuildOptions" :key="opt.key" :value="opt.key">{{ t(opt.name) }}</option>
										</select>
									</label>
									<label v-if="isGlobe" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 220px;" :title="t('仅对跨太平洋线路执行球面插值（slerp）重算，自动跨越日期变更线连接，避免 3D 视图断线。')">
										<span>{{ t('3D 海缆重算') }}</span>
										<el-tooltip effect="dark" placement="top" :content="t('仅跨太平洋线路：球面插值（slerp）跨越日期变更线自动连通；默认加载已保存 3D 重算数据。')">
											<i class="el-icon-info" aria-hidden="true"></i>
										</el-tooltip>
										<select v-model="threeDRebuildMode" @change="onThreeDRebuildModeChange" :disabled="modeSwitching" style="min-width: 150px;">
											<option v-for="opt in threeDRebuildOptions" :key="opt.key" :value="opt.key">{{ t(opt.name) }}</option>
										</select>
									</label>
									<label v-if="isGlobe" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 220px;" :title="t('控制 3D 球面插值的采样间隔（km），步距越小越平滑、点数越多；步距越大越省资源。')">
										<span>{{ t('弧段步距') }}</span>
										<el-tooltip effect="dark" placement="top" :content="t('3D 球面插值的采样间隔（km）：越小越平滑、点数越多；越大越省性能。默认 150 km。')">
											<i class="el-icon-info" aria-hidden="true"></i>
										</el-tooltip>
										<select v-model.number="threeDArcStepKm" @change="onThreeDArcStepChange" :disabled="modeSwitching" style="min-width: 150px;">
											<option v-for="opt in threeDArcStepOptions" :key="opt.value" :value="opt.value">{{ t(opt.label) }}</option>
										</select>
									</label>
									<label v-if="!isGlobe && mapVersion !== 'tiles'" class="btn ghost" style="display:inline-flex; align-items:center; gap:8px; min-width: 220px;">
										<span>{{ t('2D 地图版本') }}</span>
										<select v-model="mapVersion" @change="onMapVersionChange" :disabled="modeSwitching" style="min-width: 150px;">
											<option v-for="opt in mapVersionOptions" :key="opt.key" :value="opt.key">{{ t(opt.name) }}</option>
										</select>
									</label>
									<div class="btn ghost" style="display:flex; align-items:center; gap:8px; grid-column: 1 / -1; flex-wrap:wrap;">
										<span>{{ t('语言') }}</span>
										<div style="display:flex; gap:6px; flex-wrap:wrap;">
											<button class="inline-btn" @click="toggleGlobalLang">{{ globalLang==='zh' ? t('International') : '中文版' }}</button>
										</div>
									</div>
									<button class="btn ghost" :disabled="modeSwitching" @click="openHelp"><i class="el-icon-question" style="margin-right:4px;"></i>{{ t('帮助') }}</button>
								</div>
							</div>
						</div>
					</div>
					<!-- 打点提示条：进入打点时的悬浮提示 -->
					<div v-if="faultEditState.picking" class="fault-pick-toast">{{ t('打点模式：请在故障涉及海缆走线上单击故障点，自动写入经纬度和距离') }}</div>
					<!-- 打点确认条：写入后显示距离/坐标并给出操作按钮 -->
					<div v-if="faultPickConfirmVisible" class="fault-pick-confirm">
						<div>{{ t('已写入：') }}{{ faultEditState.pointCoord || '--' }} ｜ {{ faultEditState.distance || '--' }} km</div>
						<div class="actions">
							<button class="inline-btn" :disabled="faultEditState.saving" @click.stop="confirmFaultPickSave()">{{ t('保存并退出打点') }}</button>
							<button class="inline-btn" @click.stop="continueFaultPick()">{{ t('继续打点') }}</button>
							<button class="inline-btn" @click.stop="exitFaultPointPick()">{{ t('退出打点') }}</button>
						</div>
					</div>
					<!-- 打点浮窗：右下实时展示当前编辑组写入，精简字段与动作布局 -->
					<div v-if="faultEditState.active && faultEditState.picking" class="fault-pick-floating" :style="faultPickPanelStyle" :title="t('按住标题可拖动，右下角可拖拉高宽')">
						<div class="title" :style="faultPickPanelTitleStyle" @mousedown.stop="startFaultPickPanelDrag">{{ t('编辑第') }} {{ faultEditState.index }} {{ t('组') }}</div>
						<div class="line" style="display:flex; align-items:center; gap:6px;">
							<span>{{ t('海缆') }}</span>
							<el-select class="fault-edit-select mini" v-model="faultEditState.cable" filterable clearable :placeholder="t('选择或搜索海缆')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown" @change="onPickCableChange" style="flex:1;">
								<el-option v-for="nm in cableNameOptions" :key="nm" :label="nm" :value="nm"></el-option>
							</el-select>
						</div>
						<div class="line" style="display:flex; align-items:center; gap:6px;">
							<span>{{ t('登陆站') }}</span>
							<el-select class="fault-edit-select mini" v-model="faultEditState.landing" filterable clearable :placeholder="t('选择或搜索登陆站')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown" @change="onPickLandingChange" style="flex:1;">
								<el-option v-for="nm in landingOptionsForEdit" :key="nm" :label="nm" :value="nm"></el-option>
							</el-select>
						</div>
						<div class="line">
							<div class="fault-pick-info-box" :style="faultPickInfoBoxStyle">
								<div class="label">{{ t('距离') }}</div>
								<div class="value" :style="faultPickInfoValueStyle">{{ faultEditState.distance || '--' }} km</div>
							</div>
						</div>
						<div class="line">
							<div class="fault-pick-info-box" :style="faultPickInfoBoxStyle">
								<div class="label">{{ t('经纬度') }}</div>
								<div class="value" :style="faultPickInfoValueStyle">{{ faultEditState.pointCoord || '--' }}</div>
							</div>
						</div>
						<div class="line">
							<label style="display:block; margin-bottom:4px;">{{ t('故障点备注') }}</label>
								<textarea class="fault-edit-input fault-remark-input" v-model="faultEditState.remark" :placeholder="t('故障点备注（可拖拽调整高宽）')" @input="autoResizeTextarea"></textarea>
						</div>
						<div class="line" v-if="faultPickLoading" style="color:#9ae5ff; display:flex; align-items:center; gap:8px;">
							<span class="spinner" aria-hidden="true" style="width:12px; height:12px; border-width:2px;"></span>
							<span>{{ faultPickLoadText || t('处理中…') }}</span>
						</div>
						<div class="actions">
							<button class="inline-btn ghost" @click.stop="faultPickPaletteVisible ? closeFaultPickPalette() : showFaultPickPalette()" :aria-pressed="faultPickPaletteVisible">
								{{ faultPickPaletteVisible ? t('关闭调色盘') : t('打开调色盘') }}
							</button>
							<button class="inline-btn" :class="{ 'is-loading': faultEditState.saving }" :disabled="faultEditState.saving" @click.stop="confirmFaultPickSave()">{{ t('保存') }}</button>
							<button class="inline-btn" @click.stop="exitFaultPointPick()">{{ t('退出打点') }}</button>
						</div>
					</div>
					<div v-if="faultPickPaletteVisible && faultEditState.active" class="fault-pick-palette-floating" :style="faultPickPaletteStyle">
						<div class="palette-header" style="justify-content:flex-end;">
							<button class="close-btn" @click="closeFaultPickPalette" :aria-label="t('关闭调色盘')">×</button>
						</div>
						<div class="palette-grid">
							<label class="palette-item">
								<span>{{ t('背景') }}</span>
								<div class="palette-controls">
									<input type="color" v-model="faultPickPanelPalette.bgColor" @input="saveFaultPickPalette" title="bg" class="palette-color">
									<input type="range" min="0" max="1" step="0.02" v-model.number="faultPickPanelPalette.bgOpacity" @input="saveFaultPickPalette" :title="t('透明度')" class="palette-range">
								</div>
							</label>
							<label class="palette-item">
								<span>{{ t('边框') }}</span>
								<div class="palette-controls">
									<input type="color" v-model="faultPickPanelPalette.borderColor" @input="saveFaultPickPalette" title="border" class="palette-color">
								</div>
							</label>
							<label class="palette-item">
								<span>{{ t('文字') }}</span>
								<div class="palette-controls">
									<input type="color" v-model="faultPickPanelPalette.textColor" @input="saveFaultPickPalette" title="text" class="palette-color">
								</div>
							</label>
							<label class="palette-item">
								<span>{{ t('标题') }}</span>
								<div class="palette-controls">
									<input type="color" v-model="faultPickPanelPalette.titleColor" @input="saveFaultPickPalette" title="title" class="palette-color">
								</div>
							</label>
							<label class="palette-item">
								<span>{{ t('阴影') }}</span>
								<div class="palette-controls">
									<input type="color" v-model="faultPickPanelPalette.shadowColor" @input="saveFaultPickPalette" title="shadow" class="palette-color">
									<input type="range" min="0" max="1" step="0.02" v-model.number="faultPickPanelPalette.shadowOpacity" @input="saveFaultPickPalette" :title="t('透明度')" class="palette-range">
								</div>
							</label>
						</div>
						<div class="palette-actions">
							<button class="inline-btn" @click.stop="saveFaultPickPalette(false)">{{ t('保存样式') }}</button>
							<button class="inline-btn ghost" @click.stop="resetFaultPickPalette()">{{ t('恢复默认') }}</button>
						</div>
					</div>
					<div id="worldCableMap" ref="map"></div>
					<!-- 弹出缩放滑条：玻璃质感、无标题，带抛物线+Q弹动画 -->
					<div v-show="zoomPopoverVisible" class="zoom-popover" :style="zoomPopoverStyle">
						<button class="close-btn" @click="toggleZoomPopover" :aria-label="tLabel('关闭')" :title="tLabel('关闭')" style="position:absolute; right:8px; top:6px; background:rgba(255,255,255,0.12); border:0; color:#e8f7ff; font-size:16px; cursor:pointer; line-height:1; width:22px; height:22px; border-radius:6px;">×</button>
						<div style="display:flex; align-items:center; gap:12px; padding-right:20px;">
							<input type="range" min="0" max="100" v-model.number="zoomSlider" @input="onZoomSlider" style="flex:1; height:12px; accent-color:#9ae5ff; background:transparent;">
						</div>
					</div>
					<div v-if="mapLoading" class="panel-loading">
						<span class="spinner" aria-hidden="true"></span>
						<span class="text">{{ mapLoadingText || t('地图加载中…') }}</span>
					</div>
					<!-- 地图中心提示：用于无定位等场景的短暂科技风提示 -->
					<div v-if="mapCenterToast.show" class="map-center-toast" :class="mapCenterToast.type">
						<div class="toast-inner">
							<i :class="mapCenterToast.type === 'warning' ? 'el-icon-warning-outline' : 'el-icon-info'" aria-hidden="true"></i>
							<span>{{ mapCenterToast.message }}</span>
						</div>
					</div>
					<!-- 使用说明弹层 -->
					<div v-if="helpVisible" class="help-modal-overlay" @click.self="closeHelp">
						<div class="help-modal">
							<div class="help-header">
								<h3>{{ t('使用说明与提示') }}</h3>
								<button class="close-btn" @click="closeHelp" :aria-label="t('关闭')">×</button>
							</div>
							<div class="help-content">
								<h4>{{ t('瓦片 7 级与路径升级（v6.5）') }}</h4>
								<ul>
									<li>{{ t('瓦片目录切换为 img/tiles_world_img 的 z/x/y 结构，默认开放到第 7 级。') }}</li>
									<li>{{ t('滚轮/按钮/缩放滑条/聚焦上限统一至 7 级，叠加层与底图保持一致。') }}</li>
									<li>{{ t('保留 overzoom 兼容，便于后续扩容更高等级瓦片。') }}</li>
								</ul>
								<h4>{{ t('全局 i18n 与紧凑修复（v6.0）') }}</h4>
								<ul>
									<li>{{ t('词典去重并补齐国家/城市、按钮与下拉选项翻译，3D 故障标签与“前 x 条”列表同步翻译。') }}</li>
									<li>{{ t('紧凑海缆/故障详情 per-item 语言切换与大屏一致，紧凑瓦片/列表常驻渲染修复。') }}</li>
									<li>{{ t('帮助弹窗与 README 版本节点同步 v6.0，确保九模式与 i18n 统一口径。') }}</li>
								</ul>
								<h4>{{ t('Speed Dial 控制台') }}</h4>
								<ul>
									<li>{{ t('主按钮：2D/3D 切换、全屏、工具开关。') }}</li>
									<li>{{ t('折叠面板：复位视角、显示站名、缩放滑条、标题背景、2D 底图/3D 纹理、故障叠加层、2D 重算、地图版本。') }}</li>
								</ul>
								<h4>{{ t('地图版本与坐标') }}</h4>
								<ul>
									<li>{{ t('支持 ap-zh（亚太中心）、std-zh/std-en（标准版）。') }}</li>
									<li>{{ t('版本切换时，故障定位点与标记自动转换；更新后自动居中焦点。') }}</li>
									<li>{{ t('列表与 Tooltip 的坐标随当前版本映射。') }}</li>
								</ul>
								<h4>{{ t('模式切换与稳定性') }}</h4>
								<ul>
									<li>{{ t('全屏切换采用“退出聚焦→切换→恢复聚焦”，避免地图空白。') }}</li>
									<li>{{ t('紧凑→大屏沿用同策略，拖拽/切换后执行分时多次重绘。') }}</li>
									<li>{{ t('打点模式下退出全屏等同退出打点。') }}</li>
								</ul>
								<h4>{{ t('默认与适配') }}</h4>
								<ul>
									<li>{{ t('首次加载默认紧凑模式（除非屏幕宽度 > 3000px）。') }}</li>
									<li>{{ t('Speed Dial 面板设定最大高度并支持滚动，适配小屏。') }}</li>
									<li>{{ t('紧凑模式标题与搜索框高度下调以避免遮挡。') }}</li>
								</ul>
								<h4>{{ t('版本里程碑（摘自 README）') }}</h4>
								<div class="help-version-grid">
									<div class="version-card">
										<div class="version-badge">v1.0</div>
										<div class="version-meta">{{ t('2025-12-01 · 响应式布局上线') }}</div>
										<p>{{ t('实现大屏 / 紧凑的响应式布局切换，支持多分辨率适配与布局持久化。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v1.5</div>
										<div class="version-meta">{{ t('2025-12-15 · 2D 模式完成') }}</div>
										<p>{{ t('完善 2D 地图渲染，支持海缆 / 登陆站基础展示与筛选、聚焦联动。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v2.0</div>
										<div class="version-meta">{{ t('2025-12-27 · 打点算法上线') }}</div>
										<p>{{ t('上线故障打点与沿线测距，提供高精度故障定位与态势联动。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v2.5</div>
										<div class="version-meta">{{ t('2026-01-05 · 3D 模式完成') }}</div>
										<p>{{ t('完成 3D 地球模式，支持纹理切换、故障叠加与粒子尾迹效果。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v3.0</div>
										<div class="version-meta">{{ t('2026-01-12 · 后台布局优化') }}</div>
										<p>{{ t('支持海缆数据重算与保存，后台布局优化以换取稳定性能。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v3.5</div>
										<div class="version-meta">{{ t('2026-01-15 · 接入生产信息系统') }}</div>
										<p>{{ t('引入登录验证并与生产信息系统生态融合，同时保留重算与后台稳定性优化。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v4.0</div>
										<div class="version-meta">{{ t('2026-01-16 · 权限管理与审计') }}</div>
										<p>{{ t('基于角色的权限模型与操作审计，支持按功能/数据域授权并对接 SSO/Token。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v5.0</div>
										<div class="version-meta">{{ t('2026-01-20 · 详细版世界地图') }}</div>
										<p>{{ t('高分辨率瓦片与矢量混合，按视口懒加载，支持离线包与导出接口。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v5.5</div>
										<div class="version-meta">{{ t('2026-01-21 · 瓦片打点与深度优化') }}</div>
										<p>{{ t('瓦片地图新增打点、沿线测距与定位回填，与九大模式保持一致；首次进入 3D 的加载拆分并模拟退出聚焦/勾选所有故障。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v6.0</div>
										<div class="version-meta">{{ t('2026-01-23 · 全局 i18n + 紧凑修复') }}</div>
										<p>{{ t('词典去重并补齐国家/城市、按钮与下拉选项翻译，3D 故障标签与“前 x 条”列表同步翻译；紧凑面板常驻渲染修复，海缆/故障详情 per-item 语言切换统一。') }}</p>
									</div>
									<div class="version-card">
										<div class="version-badge">v6.5</div>
										<div class="version-meta">{{ t('2026-01-23 · 瓦片 7 级升级') }}</div>
										<p>{{ t('瓦片目录统一为 img/tiles_world_img 的 z/x/y 结构，开放到第 7 级并统一缩放上限，叠加层与底图路径一致。') }}</p>
									</div>
								</div>
								<h4>{{ t('未来规划（摘要）') }}</h4>
								<ul class="roadmap-list">
									<li><span class="roadmap-pill">v6.6 · 2026-Q2</span> {{ t('瓦片 8 级与离线包：扩容高等级瓦片并提供离线包/校验与加载监控，叠加层同步路径。') }}</li>
									<li><span class="roadmap-pill">v7.0 · 2026-Q4</span> {{ t('中国移动海陆缆系统：融合站点/海缆全量数据，预置模板与 KPI 看板。') }}</li>
									<li><span class="roadmap-pill">v8.0 · 2027-Q1</span> {{ t('AI 协同运维：LLM 运维助手与异常自愈提示。') }}</li>
									<li><span class="roadmap-pill">v9.0 · 2027-Q3</span> {{ t('海缆系统智能体：自动生成故障打点、影响评估与修复建议。') }}</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</section>
			<!-- 外侧左右分隔条（仅大屏模式） -->
			<div v-if="!isCompactMode" class="splitter-v" :style="{ left: 'calc(' + leftColPct + '% + 9px)', top: '10px', height: 'calc(100% - 20px)', zIndex: 50 }" @mousedown="startDragScreenLeft"></div>
			<div v-if="!isCompactMode" class="splitter-v" :style="{ left: 'calc(' + (leftColPct + centerColPct) + '% + 9px)', top: '10px', height: 'calc(100% - 20px)', zIndex: 50 }" @mousedown="startDragScreenRight"></div>

			<!-- 右：海缆状态控制台 -->
			<section class="panel right" v-if="!isCompactMode">
				<div class="panel-header" style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
					<div><span class="accent"></span>{{ t('海缆状态控制台') }}</div>
				</div>
				<div class="panel-body">
					<div class="lists" ref="listsGrid" :style="{ position: 'relative', display: 'grid', gridTemplateColumns: leftPanePct + '%' + ' ' + (100-leftPanePct) + '%', gridTemplateRows: topHeightPct + '%' + ' ' + (100-topHeightPct) + '%', gap: '10px', height: '100%' }">
						<!-- 垂直分隔条（左右） -->
						<div class="splitter-v" :style="{ left: 'calc(' + leftPanePct + '% + 1px)', top: '0', height: 'calc(' + topHeightPct + '%)' }" @mousedown="startDragV"></div>
						<!-- 水平分隔条（上下） -->
						<div class="splitter-h" :style="{ top: 'calc(' + topHeightPct + '% )', left: '0', width: '100%' }" @mousedown="startDragH"></div>
						<div class="list-row" style="grid-row:1; grid-column:1; min-width: 280px; min-height: 200px; overflow: hidden;">
							<div class="list-block" v-show="!(floatingPanel.active && floatingPanel.type==='cable')" style="grid-row:1; grid-column:1;">
								<div class="title-row with-search">
										<h3 style="margin: 0;">{{ t('海缆列表') }}</h3>
										<div class="searchbar">
											<input type="text" v-model="searchCable" :placeholder="t('搜索海缆名称')" />
											<button v-if="searchCable" class="clear-btn" @click="searchCable=''">×</button>
										</div>
										<button class="inline-btn drag-btn" :title="t('点击拖动')" @click="openFloating('cable')" style="margin-left:8px;">{{ t('点击拖动') }}</button>
								</div>
								<div class="list">
									<div v-if="cablePageItems.length === 0" class="empty">{{ t('暂无数据') }}</div>
									<div v-else>
										<div v-for="(line, i) in cablePageItems"
											:key="(line.feature_id || line.id || line.name) + '-' + i">
											<div class="item"
												:class="{ expanded: cableDetail.id === line.id, active: (focusMode==='cable' && focusedCableId===line.id) }"
												@click="onCableItemClick(line)"
												@mouseenter="showCableTooltip(line, $event)"
												@mousemove="moveCableTooltip($event)" @mouseleave="hideCableTooltip">
												<div class="primary" style="gap:10px;">
													<span>{{ line.name }}</span>
													<span class="ownership-tag" :class="line.ownershipClass">{{
														line.ownership ? t(line.ownership) : t('非权益') }}</span>
													<button class="inline-btn"
														@click.stop="toggleCableDetail(line)">{{ cableDetail.id === line.id ? t('收起详情') : t('详情') }}</button>
												</div>
												<div class="badge" :class="{ ok: !isCableFaulted(line), err: isCableFaulted(line) }">{{ isCableFaulted(line) ? t('中断') : t('运行中') }}</div>
											</div>
											<div v-if="cableDetail.id === line.id" class="cable-detail">
												<div class="title">{{ line.name || '海缆' }}
													<div>
														<button class="inline-btn"
															@click.stop="toggleItemLang('cable', line.id)">{{
															getItemLang('cable', line.id) === 'zh' ? '中' : 'EN'
															}}</button>
														<button class="inline-btn"
															@click.stop="copyText(line.name || '', '名称')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
														<button class="inline-btn"
															@click.stop="toggleShowLandingLabels()"
															style="display:none;">{{ showLandingLabels ? t('隐藏登陆站名') :
															t('显示登陆站名') }}</button>
														<button class="inline-btn expand"
															@click.stop="openCableModal(line)">{{ tWithLang('展开', getItemLang('cable', line.id)) }}</button>
													</div>
												</div>
													<div class="rows">
													<div class="row">
														<div class="key">{{ tLabel('branch','cable', line.id) }}
														</div>
														<div class="val">{{ t('敬请期待') }}</div>
													</div>
													<div class="row">
														<div class="key">{{ tLabel('name','cable', line.id) }}</div>
														<div class="val">{{ line.name }} <button class="inline-btn"
															@click.stop="copyText(line.name || '', getItemLang('cable', line.id) === 'zh' ? '名称' : 'Name')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
														</div>
													</div>
													<div class="row">
														<div class="key">{{ tLabel('id','cable', line.id) }}</div>
														<div class="val">{{ line.id }} <button class="inline-btn"
															@click.stop="copyText(line.id || '', getItemLang('cable', line.id) === 'zh' ? '编号' : 'ID')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
														</div>
													</div>
													<div class="row">
														<div class="key">{{ tLabel('feature_id','cable', line.id) }}
														</div>
														<div class="val">{{ line.feature_id || '-' }} <button
															class="inline-btn"
															@click.stop="copyText(line.feature_id || '', 'feature_id')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
														</div>
													</div>
													<div class="row">
														<div class="key">{{ tLabel('ownership','cable', line.id) }}
														</div>
														<div class="val">{{ line.ownership ? t(line.ownership) : t('非权益') }}</div>
													</div>
													<div class="row">
														<div class="key">{{ tWithLang('局向', getItemLang('cable', line.id)) }}</div>
														<div class="val">{{ displayDirection(line.direction ||
															cableDetail.detail?.direction) }}</div>
													</div>
													<div class="row">
														<div class="key">{{ tWithLang('洲别', getItemLang('cable', line.id)) }}</div>
														<div class="val">{{ displayContinents(line.continents ||
															cableDetail.detail?.continents || line.continent ||
															cableDetail.detail?.continent) ||
															displayMacroRegion(line.continent ||
															cableDetail.detail?.continent) || '-' }}</div>
													</div>
													<div class="row">
														<div class="key">{{ tLabel('rfs_year','cable', line.id) }}
														</div>
														<div class="val">{{ cableDetail.detail?.rfs_year || '-' }}
														</div>
													</div>
													<div class="row">
														<div class="key">{{ tLabel('is_planned','cable', line.id) }}
														</div>
														<div class="val">{{ cableDetail.detail?.is_planned ?
															(getItemLang('cable', line.id) === 'zh' ? '是' : 'Yes') :
															(getItemLang('cable', line.id) === 'zh' ? '否' : 'No') }}
														</div>
													</div>
													<div class="row" v-if="cableDetail.detail?.length">
														<div class="key">{{ tLabel('length','cable', line.id) }}
														</div>
														<div class="val">{{ cableDetail.detail.length }}</div>
													</div>
													<div class="row" v-if="getCableUrl(line)">
														<div class="key">{{ tLabel('website','cable', line.id) }}
														</div>
														    <div class="val"><button class="link-btn"
															    @click.stop="openUrl(getCableUrl(line))">{{ tWithLang('官网', getItemLang('cable', line.id)) }}</button>
														</div>
													</div>
													<div class="row"
														v-if="cableDetail.detail?.owners || cableDetail.detail?.owner">
														<div class="key">{{ tLabel('owners','cable', line.id) }}
														</div>
														<div class="val"><span class="owner-text"
																:class="{ expanded: isExpanded(line.id, 'owners') }"
																@click.stop="toggleExpand(line.id, 'owners')"><template
																	v-if="isExpanded(line.id, 'owners')">{{
																	displayOwnerText(line.id) }}</template><template
																	v-else>{{ displayOwnerText(line.id) }}<span
																		v-if="needsOwnerEllipsis(line.id)"
																		class="owner-ell">…</span></template></span>
														</div>
													</div>
													<div class="row" v-if="cableDetail.detail?.suppliers">
														<div class="key">{{ tLabel('suppliers','cable', line.id) }}
														</div>
														<div class="val">{{
															translateEntities(cableDetail.detail.suppliers,
															getItemLang('cable', line.id)) }}</div>
													</div>
													<div class="row">
														<div class="key">{{ tLabel('landings','cable', line.id) }}
														</div>
														<div class="val">
															<div class="inline-flex">
																<span class="meta-count">{{
																	landingCount(cableDetail.detail) }} {{ unitLabel('个', getItemLang('cable', line.id)) }}</span>
																<select v-if="landingCount(cableDetail.detail) > 0"
																	v-model="cableDetail.landingLimit" @click.stop
																	class="mini-select">
																	<option :value="8">{{ tWithLang('前 8 条', getItemLang('cable', line.id)) }}</option>
																	<option :value="15">{{ tWithLang('前 15 条', getItemLang('cable', line.id)) }}</option>
																	<option value="all">{{ tWithLang('全部', getItemLang('cable', line.id)) }}</option>
																</select>
															</div>
															<div v-if="landingCount(cableDetail.detail) > 0"
																class="lines indent-lines" style="margin-top:6px;">
																<div class="line"
																	v-for="(lp,i2) in cableLandingLimited()"
																	:key="lp.id || i2"
																	@click.stop="focusLandingByRef(lp)">
																	<span class="name">{{ normalizeText(lp.name)
																		}}</span>
																	<span class="meta" v-if="lp.country">{{
																		translateCountryToZh(normalizeText(lp.country))
																		}}</span>
																</div>
																<div class="more"
																	v-if="landingCount(cableDetail.detail) > cableLandingVisibleCount()">
																	{{ tWithLang('等', getItemLang('cable', line.id)) }} {{ landingCount(cableDetail.detail) -
																	cableLandingVisibleCount() }} {{ unitLabel('条', getItemLang('cable', line.id)) }}…</div>
															</div>
															<span v-else>{{ t('暂无') }}</span>
														</div>
													</div>
												</div>

												<div v-if="cableDetail.loading" style="color:#8aa4c4; margin-top:4px;">
													{{ t('详情加载中…') }}</div>
											</div>
										</div>
									</div>
								</div>
								<div class="list-footer">
									<div class="page-size" v-if="cablePaginationAdvanced">
										{{ t('每页') }}
										<select v-model.number="cablePageSize">
											<option :value="20">20</option>
											<option :value="50">50</option>
											<option :value="100">100</option>
										</select>
										{{ t('条') }}｜{{ t('共') }} {{ cableTotal }} {{ t('条') }}
									</div>
									<div class="actions">
										<button @click="prevCablePage" :disabled="cablePage <= 1">{{ t('上一页') }}</button>
										<button @click="nextCablePage"
											:disabled="cablePage >= cableTotalPages">{{ t('下一页') }}</button>
									</div>
									<div class="page-jump" v-if="cablePaginationAdvanced">
										{{ t('跳转') }}
										<input type="number" v-model.number="cablePageInput" @keyup.enter="goCablePage"
											min="1" :max="cableTotalPages" />
										<button @click="goCablePage">{{ t('Go') }}</button>
									</div>
									<label class="quick-toggle">
										<input type="checkbox" v-model="cablePaginationAdvanced" />
										{{ t('高级') }}
									</label>
									<div class="page-info">{{ t('第') }} {{ cablePage }} / {{ cableTotalPages }} {{ t('页') }}</div>
								</div>
							</div>
							<div class="list-block" v-show="!(floatingPanel.active && floatingPanel.type==='landing')" style="grid-row:1; grid-column:2; min-width: 280px; min-height: 200px; overflow: hidden;">
								<div class="title-row with-search">
									<h3 style="margin: 0;">{{ t('登陆站列表') }}</h3>
									<div class="searchbar">
										<input type="text" v-model="searchLanding" :placeholder="t('搜索登陆站坐标或名称')" />
										<button v-if="searchLanding" class="clear-btn"
											@click="searchLanding=''">×</button>
									</div>
									<button class="inline-btn drag-btn" :title="t('点击拖动')" @click="openFloating('landing')" style="margin-left:8px;">{{ t('点击拖动') }}</button>
								</div>
								<div class="list">
									<div v-if="landingPageItems.length === 0" class="empty">{{ t('暂无数据') }}</div>
									<div v-else>
										<div v-for="(lp, i) in landingPageItems" :key="lp.coordStr + i">
											<div class="item"
												:class="{ expanded: landingDetail.id === lp.id, active: (focusMode==='landing' && focusedLanding && focusedLanding.id===lp.id) }"
												@click="onLandingItemClick(lp)"
												@mouseenter="showLandingTooltip(lp, $event)"
												@mousemove="moveLandingTooltip($event)" @mouseleave="hideLandingTooltip"
												:title="t('点击聚焦')">
												<div class="primary">
													<!-- 去掉箭头icon -->
													<span>{{ normalizeText(lp.name || ('登陆站 ' + (i+1))) }}</span>
													<span class="ownership-tag" :class="lp.ownershipClass">{{ lp.ownership ? t(lp.ownership) : t('非权益') }}</span>
													<span class="badge" :class="isLandingInvolved(lp) ? 'warn' : 'ok'" style="margin-left:6px;">{{ isLandingInvolved(lp) ? t('涉及故障') : t('运行中') }}</span>
													<button class="inline-btn"
														@click.stop="toggleLandingDetail(lp)">{{ landingDetail.id === lp.id ? t('收起详情') : t('详情') }}</button>
												</div>
												<div class="badge">{{ displayCountryLabel(lp.country || t('未标注'), getItemLang('landing', lp.id)) }}</div>
											</div>
											<div v-if="landingDetail.id === lp.id" class="landing-detail">
												<div class="title">{{ normalizeText(lp.name || '登陆站') }}
													<div>
														<button class="inline-btn"
															@click.stop="toggleItemLang('landing', lp.id)">{{
															getItemLang('landing', lp.id) === 'zh' ? '中' : 'EN'
															}}</button>
														<button class="inline-btn"
															@click.stop="copyText(lp.name || '', '名称')">{{ tWithLang('复制', getItemLang('landing', lp.id)) }}</button>
														<button class="inline-btn"
															@click.stop="toggleShowLandingLabels()"
															style="display:none;">{{ showLandingLabels ? t('隐藏登陆站名') :
															t('显示登陆站名') }}</button>
														<button class="inline-btn expand"
															@click.stop="openLandingModal(lp)">{{ tWithLang('展开', getItemLang('landing', lp.id)) }}</button>
													</div>
												</div>
												<div class="rows">
													<div class="row">
														<div class="key">{{ tLabel('coords','landing', lp.id) }}
														</div>
														<div class="val">
															<span v-if="lp.coords && lp.coords.length >= 2">Lon {{
																Number(lp.coords[0]).toFixed(3) }}, Lat {{
																Number(lp.coords[1]).toFixed(3) }}</span>
															<button class="inline-btn"
																@click.stop="copyText(lp.coordStr || '', '坐标')">{{ tWithLang('复制', getItemLang('landing', lp.id)) }}</button>
															<span v-else>-</span>
														</div>
													</div>
													<div class="row" v-if="lp.id">
														<div class="key">{{ tLabel('id','landing', lp.id) }}</div>
														<div class="val">{{ lp.id }}</div>
													</div>
													<div class="row" v-if="lp.is_tbd !== undefined">
														<div class="key">{{ tLabel('is_tbd','landing', lp.id) }}
														</div>
														<div class="val">{{ lp.is_tbd ? (getItemLang('landing',
															lp.id) === 'zh' ? '是' : 'Yes') : (getItemLang('landing',
															lp.id) === 'zh' ? '否' : 'No') }}</div>
													</div>
													<div class="row" v-if="landingDetail.detail?.country || lp.country">
														<div class="key">{{ tLabel('country','landing', lp.id) }}
														</div>
														<div class="val">{{
															translateCountryToZh(normalizeText(landingDetail.detail?.country
															|| lp.country)) }}</div>
													</div>
													<div class="row">
														<div class="key">{{ tWithLang('局向', getItemLang('landing', lp.id)) }}</div>
														<div class="val">{{ displayDirection(lp.direction ||
															landingDetail.detail?.direction) }}</div>
													</div>
													<div class="row">
														<div class="key">{{ tWithLang('洲别', getItemLang('landing', lp.id)) }}</div>
														<div class="val">{{ displayContinents(lp.continent ||
															landingDetail.detail?.continent || lp.continentMacro ||
															landingDetail.detail?.continentMacro) ||
															displayMacroRegion(lp.continent ||
															landingDetail.detail?.continent || lp.continentMacro ||
															landingDetail.detail?.continentMacro) || '-' }}</div>
													</div>
													<div class="row clickable"
														@click.stop="setLandingCableLimit('all')">
														<div class="key">{{ tLabel('cables','landing', lp.id) }}
														</div>
														<div class="val inline-flex">{{
															landingDetail.detail?.cables?.length || 0 }} {{ unitLabel('条', getItemLang('landing', lp.id)) }} <span
																v-if="landingDetail.loading">（{{ t('加载中…') }}）</span>
															<select v-if="landingDetail.detail?.cables?.length"
																v-model="landingDetail.cableLimit" @click.stop
																class="mini-select">
																<option :value="8">{{ tWithLang('前 8 条', getItemLang('landing', lp.id)) }}</option>
																<option :value="15">{{ tWithLang('前 15 条', getItemLang('landing', lp.id)) }}</option>
																<option value="all">{{ tWithLang('全部', getItemLang('landing', lp.id)) }}</option>
															</select>
														</div>
													</div>
												</div>
												<div v-if="landingDetail.detail?.cables?.length"
													class="lines indent-lines">
													<div class="line" v-for="(cb, idx) in landingCableLimited"
														:key="cb.id || idx"
														style="cursor:pointer; align-items:center; gap:8px;"
														@click.stop="focusCableByRef(cb)">
														<span class="name">{{ normalizeText(cb.name) }}</span>
														<span class="meta">{{ t('商用年') }} {{ cb.rfs_year || '-' }} <span
															class="planned" v-if="cb.is_planned">{{ t('规划中') }}</span></span>
													</div>
													<div class="more"
														v-if="landingDetail.detail.cables.length > landingCableVisibleCount">
														{{ tWithLang('等', getItemLang('landing', lp.id)) }} {{ landingDetail.detail.cables.length -
														landingCableVisibleCount }} {{ unitLabel('条', getItemLang('landing', lp.id)) }}…</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="list-footer">
									<div class="page-size" v-if="landingPaginationAdvanced">
												{{ t('每页') }}
										<select v-model.number="landingPageSize">
											<option :value="20">20</option>
											<option :value="50">50</option>
											<option :value="100">100</option>
										</select>
										{{ t('条') }}｜{{ t('共') }} {{ landingTotal }} {{ t('条') }}
									</div>
									<div class="actions">
										<button @click="prevLandingPage" :disabled="landingPage <= 1">{{ t('上一页') }}</button>
										<button @click="nextLandingPage"
											:disabled="landingPage >= landingTotalPages">{{ t('下一页') }}</button>
									</div>
									<div class="page-jump" v-if="landingPaginationAdvanced">
										{{ t('跳转') }}
										<input type="number" v-model.number="landingPageInput"
											@keyup.enter="goLandingPage" min="1" :max="landingTotalPages" />
										<button @click="goLandingPage">{{ t('Go') }}</button>
									</div>
									<label class="quick-toggle">
										<input type="checkbox" v-model="landingPaginationAdvanced" />
										{{ t('高级') }}
									</label>
									<div class="page-info">{{ t('第') }} {{ landingPage }} / {{ landingTotalPages }} {{ t('页') }}</div>
								</div>
							</div>
						</div>
						<div class="list-block" v-show="!(floatingPanel.active && floatingPanel.type==='fault')" style="grid-row:2; grid-column:1 / span 2; min-width: 280px; min-height: 200px; overflow: hidden;">
							<div class="title-row with-search faults-header" style="flex-wrap:wrap; gap:10px;">
								<div style="display:flex; align-items:center; gap:10px; flex:1 1 auto; min-width:260px;">
										<h3 style="margin: 0;">{{ t('故障列表') }}</h3>
										<button class="inline-btn" :title="t('点击拖动')" @click="openFloating('fault')" style="margin-left:8px;">{{ t('点击拖动') }}</button>
										<label class="quick-toggle" style="white-space:nowrap;">
											<input type="checkbox" v-model="faultOnlyOnMap" @change="updateChart" />
											{{ t('仅显示故障') }}
										</label>
										<label class="quick-toggle" style="white-space:nowrap;">
											<input type="checkbox" v-model="showFaultCablesOnMap" @change="updateChart" />
											{{ t('地图显示所有故障海缆') }}
										</label>
									<button class="inline-btn" @click="toggleRealtime" style="margin-left:8px;">
											{{ realtimeEnabled ? t('关闭实况') : t('开启实况') }}
									</button>
									<div class="realtime-box" style="display:flex; align-items:center; gap:6px; flex-wrap:wrap; max-width: 300px; overflow:hidden;">
											<span class="countdown" style="color:#8aa4c4; font-size:11px;">{{ t('下次刷新：') }}{{ Math.floor((realtimeCountdown||0)/60) }}:{{ ((realtimeCountdown||0)%60).toString().padStart(2,'0') }}</span>
										<div class="marquee" style="flex:1 1 auto; min-width:140px; max-width:300px; overflow:hidden; white-space:nowrap;">
											<div class="marquee-inner">{{ realtimeMessage }}</div>
										</div>
									</div>
								</div>
								<div class="searchbar" style="flex:1 1 260px;">
									<input type="text" v-model="searchFault" :placeholder="t('搜索故障海缆')" />
									<button v-if="searchFault" class="clear-btn" @click="searchFault=''">×</button>
								</div>
								<div class="fault-stats"
									style="display:flex; align-items:center; gap:8px; color:#8aa4c4; font-size:12px; flex-wrap:wrap;">
									<span v-if="faultStats.major" class="badge major">{{ t('重大') }} {{ faultStats.major
									}}</span>
									<span v-if="faultStats.important" class="badge important">{{ t('重要') }} {{
									faultStats.important }}</span>
									<span>{{ t('共') }} {{ faultStats.total }} {{ t('条') }}</span>
								</div>
							</div>
							<div :class="['faults-split', { expanded: faultPanelExpanded && selectedFault }]">
								<div class="faults-left">
									<div class="list" ref="faultList">
										<div v-if="faultsLoading" class="empty loading">
											<span class="spinner" aria-hidden="true"></span>
											<span class="text">{{ t('故障加载中…') }}</span>
										</div>
										<div v-else-if="displayFaults.length === 0" class="empty">{{ t('暂无故障') }}</div>
										<div v-else>
											<div class="item" v-for="(f, i) in displayFaults" :key="f.name + i"
												:class="{ active: i === selectedFaultIndex }" :ref="'faultItem-' + i"
												@click="selectFault(f, i)" @mouseenter="showFaultTooltip(f, $event)"
												@mousemove="moveFaultTooltip($event)" @mouseleave="hideFaultTooltip($event)"
												style="grid-template-columns: 1fr; align-items: flex-start; cursor: pointer; gap:6px;">
												<div class="primary"
													style="justify-content: space-between; width: 100%;">
													<div
														style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
														<span class="fault-desc clamp4">{{ f.desc || f.description || faultTitle(f) }}</span>
														<span v-if="faultSeverityLabel(f)" class="badge" :class="faultSeverityClass(f)">{{
															faultSeverityLabel(f) }}</span>
													</div>
													<div style="display:flex; gap:6px; align-items:center;">
														<span class="badge err">{{ t('故障') }}</span>
													</div>
												</div>
												<div class="fault-meta-row">
													<span>{{ t('开始：') }}{{ safeVal(f.start) }}</span>
													<span>{{ t('结束：') }}{{ faultEndText(f) }}</span>
													<span class="pill workorder" v-if="f.workOrder">{{ t('工单') }} {{
														safeVal(f.workOrder) }}</span>
													<span class="pill duration">{{ t('历时') }} {{ liveDuration(f) }}</span>
												</div>
												<div class="fault-meta-row" v-if="f.involvedCable1 || f.involvedCable2 || f.involvedCable3">
													<span v-if="f.involvedCable1" class="distance-chip location-chip">{{ t('故障定位1') }}: {{ f.involvedCable1 }} / {{ f.involvedLanding1 || t('未填站点') }} / {{ f.distance1 || '--' }} km</span>
													<span v-if="f.involvedCable2" class="distance-chip location-chip">{{ t('故障定位2') }}: {{ f.involvedCable2 }} / {{ f.involvedLanding2 || t('未填站点') }} / {{ f.distance2 || '--' }} km</span>
													<span v-if="f.involvedCable3" class="distance-chip location-chip">{{ t('故障定位3') }}: {{ f.involvedCable3 }} / {{ f.involvedLanding3 || t('未填站点') }} / {{ f.distance3 || '--' }} km</span>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="faults-right" v-if="faultPanelExpanded && selectedFault">
									<div class="fault-detail">
										<div class="title">
											<span>{{ faultTitle(selectedFault) }}</span>
											<div class="chips">
												<span class="badge err">{{ t('故障') }}</span>
												<span class="badge" :class="faultSeverityClass(selectedFault)">{{
													faultSeverityLabel(selectedFault) }}</span>
												<span class="pill duration">{{ t('历时') }} {{ liveDuration(selectedFault)
													}}</span>
											</div>
										</div>
										<div class="fault-meta-grid loc-grid">
											<div class="fault-meta-card loc-1">
												<div class="label">{{ t('故障定位1') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(1)">{{ faultEditState.active && faultEditState.index===1 ? t('编辑中') : t('编辑') }}</button></div>
												<div class="value fault-loc-card">
													<div class="fault-loc-main">
														<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding1) || t('未填站点') }}</span>
														<span class="fault-loc-distance">{{ safeVal(selectedFault.distance1) || '--' }} km</span>
													</div>
													<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable1) || t('未填写') }}</div>
													<div class="fault-loc-remark" v-if="selectedFault.pointRemark1">{{ t('故障点备注1') }}：{{ selectedFault.pointRemark1 }}</div>
												</div>
											</div>
											<div class="fault-meta-card loc-2">
												<div class="label">{{ t('故障定位2') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(2)">{{ faultEditState.active && faultEditState.index===2 ? t('编辑中') : t('编辑') }}</button></div>
												<div class="value fault-loc-card">
													<div class="fault-loc-main">
														<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding2) || t('未填站点') }}</span>
														<span class="fault-loc-distance">{{ safeVal(selectedFault.distance2) || '--' }} km</span>
													</div>
													<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable2) || t('未填写') }}</div>
													<div class="fault-loc-remark" v-if="selectedFault.pointRemark2">{{ t('故障点备注2') }}：{{ selectedFault.pointRemark2 }}</div>
												</div>
											</div>
											<div class="fault-meta-card highlight loc-3">
												<div class="label">{{ t('故障定位3') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(3)">{{ faultEditState.active && faultEditState.index===3 ? t('编辑中') : t('编辑') }}</button></div>
												<div class="value fault-loc-card">
													<div class="fault-loc-main">
														<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding3) || t('未填站点') }}</span>
														<span class="fault-loc-distance">{{ safeVal(selectedFault.distance3) || '--' }} km</span>
													</div>
													<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable3) || t('未填写') }}</div>
													<div class="fault-loc-remark" v-if="selectedFault.pointRemark3">{{ t('故障点备注3') }}：{{ selectedFault.pointRemark3 }}</div>
												</div>
											</div>
										</div>
										<div class="fault-edit-overlay" v-if="faultEditState.active" @click.stop>
											<div class="fault-edit-overlay-inner" :style="{ transform: 'translate(' + (faultOverlayState.dx||0) + 'px,' + (faultOverlayState.dy||0) + 'px)', overflow: 'auto' }" :title="t('按住标题可拖动，右下角可拖拉高宽')">
												<div class="overlay-header" @mousedown.stop="startFaultOverlayDrag">
													<span>{{ t('编辑故障定位') }} {{ faultEditState.index }}</span>
													<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('关闭') }}</button>
												</div>
												<div class="fault-edit-group compact">
													<el-select class="fault-edit-select" v-model="faultEditState.cable" filterable clearable :placeholder="t('选择或搜索故障定位海缆')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown" @change="onEditCableChange">
														<el-option v-for="nm in cableNameOptions" :key="nm" :label="nm" :value="nm"></el-option>
													</el-select>
													<el-select class="fault-edit-select" v-model="faultEditState.landing" filterable clearable :placeholder="t('选择或搜索登陆站（需先选海缆）')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown">
														<el-option v-for="nm in landingOptionsForEdit" :key="nm" :label="nm" :value="nm"></el-option>
													</el-select>
													<input class="fault-edit-input readonly" type="text" v-model="faultEditState.distance" :placeholder="t('距离 (km)')" readonly>
													<input class="fault-edit-input readonly" type="text" v-model="faultEditState.pointCoord" :placeholder="t('故障点经纬度 (Lon,Lat)')" readonly>
													<textarea class="fault-edit-input fault-remark-input" v-model="faultEditState.remark" :placeholder="t('故障点备注（可拖拽调整高宽）')" @input="autoResizeTextarea"></textarea>
													<div class="fault-edit-actions">
														<button class="inline-btn" @click.stop="startFaultPointPick()">{{ t('打点') }}</button>
														<button class="inline-btn" :disabled="faultEditState.saving" @click.stop="saveFaultEdit()">{{ t('保存') }}</button>
														<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('取消') }}</button>
													</div>
													<span class="meta err" v-if="faultEditState.error" style="color:#ff9f7f;">{{ faultEditState.error }}</span>
												</div>
											</div>
										</div>
										<div class="rows">
											<div class="row">
												<div class="key">{{ t('涉及海缆') }}</div>
												<div class="val">{{ safeVal(selectedFault.cableName ||
													selectedFault.name) }} <button class="inline-btn"
														@click.stop="copyText(selectedFault.cableName || selectedFault.name || '', t('涉及海缆'))">{{ t('复制') }}</button>
												</div>
											</div>
											<div class="row">
												<div class="key">{{ t('故障描述') }}</div>
												<div class="val">{{ safeVal(selectedFault.desc) }} <button
														class="inline-btn"
														@click.stop="copyText(selectedFault.desc || '', t('故障描述'))">{{ t('复制') }}</button>
												</div>
											</div>
											<div class="row">
												<div class="key">{{ t('是否重大') }}</div>
												<div class="val">{{ safeVal(selectedFault.isMajor) }}</div>
											</div>
											<div class="row">
												<div class="key">{{ t('故障原因') }}</div>
												<div class="val">{{ safeVal(selectedFault.cause) }} <button
														class="inline-btn"
														@click.stop="copyText(selectedFault.cause || '', t('故障原因'))">{{ t('复制') }}</button>
												</div>
											</div>
											<div class="row">
												<div class="key">{{ t('处理进展') }}</div>
												<div class="val">{{ safeVal(selectedFault.progress) }} <button
														class="inline-btn"
														@click.stop="copyText(selectedFault.progress || '', t('处理进展'))">{{ t('复制') }}</button>
												</div>
											</div>
											<div class="row">
												<div class="key">{{ t('最近一次修改者') }}</div>
												<div class="val">{{ safeVal(selectedFault.lastModifier || (selectedFault.raw && selectedFault.raw['大屏最近一次操作用户'])) }} <button
													class="inline-btn"
													@click.stop="copyText(selectedFault.lastModifier || (selectedFault.raw && selectedFault.raw['大屏最近一次操作用户']) || '', t('最近一次修改者'))">{{ t('复制') }}</button></div>
											</div>
											<div class="row">
												<div class="key">{{ t('业务影响') }}</div>
												<div class="val">{{ safeVal(selectedFault.impact) }} <button
														class="inline-btn"
														@click.stop="copyText(selectedFault.impact || '', t('业务影响'))">{{ t('复制') }}</button>
												</div>
											</div>
											<div class="row">
												<div class="key">{{ t('备注') }}</div>
												<div class="val">{{ safeVal(selectedFault.remark) }} <button
														class="inline-btn"
														@click.stop="copyText(selectedFault.remark || '', t('备注'))">{{ t('复制') }}</button>
												</div>
											</div>
											<div class="row" v-if="selectedFault.registrar">
												<div class="key">{{ t('登记人') }}</div>
												<div class="val">{{ safeVal(selectedFault.registrar) }} <button
														class="inline-btn"
														@click.stop="copyText(selectedFault.registrar || '', t('登记人'))">{{ t('复制') }}</button>
												</div>
											</div>
											<div class="row" v-if="selectedFault.sameRoute">
												<div class="key">{{ t('同路由海缆段') }}</div>
												<div class="val">{{ safeVal(selectedFault.sameRoute) }} <button
														class="inline-btn"
														@click.stop="copyText(selectedFault.sameRoute || '', t('同路由海缆段'))">{{ t('复制') }}</button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div v-if="faultTooltip.show" ref="faultTooltip" class="tooltip-box fault-tooltip" @mouseenter="faultTooltip.show = true" @mouseleave="hideFaultTooltip($event)"
							:style="{ left: faultTooltip.left + 'px', top: faultTooltip.top + 'px' }">
								<div class="title">
									<span class="pill" :style="typeThemeStyle('cable')">{{ t('故障') }}</span>
									<span>{{ faultTitle(faultTooltip.fault) }}</span>
								</div>
								<div class="fault-tooltip-body scrollable">
									<div class="fault-loc-list">
										<template v-if="faultTooltipCables(faultTooltip.fault).length">
											<div class="loc-card" v-for="(loc, idx) in faultTooltipCables(faultTooltip.fault)" :key="idx">
												<div class="loc-head">
													<span class="pill danger-pill">{{ t('故障定位') }} {{ idx + 1 }}</span>
													<span class="loc-name">{{ safeVal(loc.cable) }}</span>
												</div>
												<div class="loc-meta">
													<span class="chip">{{ t('登陆站') }}：{{ loc.landing || t('未填站点') }}</span>
													<span class="chip">{{ t('距离') }}：{{ loc.distance || '--' }} km</span>
												</div>
											</div>
										</template>
										<div v-else class="empty">{{ t('暂未故障定点') }}</div>
									</div>
									<div class="fault-info-list">
										<div class="row">
											<div class="key">{{ t('工单号') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.workOrder) }}</div>
										</div>
										<div class="row">
											<div class="key">{{ t('开始时间') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.start) }}</div>
										</div>
										<div class="row">
											<div class="key">{{ t('结束时间') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.end) }}</div>
										</div>
										<div class="row">
											<div class="key">{{ t('故障原因') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.cause) }}</div>
										</div>
										<div class="row">
											<div class="key">{{ t('处理进展') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.progress) }}</div>
										</div>
										<div class="row">
											<div class="key">{{ t('业务影响') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.impact) }}</div>
										</div>
										<div class="row">
											<div class="key">{{ t('备注') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.remark) }}</div>
										</div>
										<div class="row">
											<div class="key">{{ t('是否重大') }}</div>
											<div class="val">{{ safeVal(faultTooltip.fault?.isMajor) }}</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div v-if="false && landingTooltip.show" ref="landingTooltip" class="tooltip-box"
						:style="[{ left: landingTooltip.left + 'px', top: landingTooltip.top + 'px' }, tooltipThemeStyle('landing', landingTooltip.lp)]">
						<div class="title">
							<span class="pill" :style="pillThemeStyle('landing', landingTooltip.lp)">登陆站</span>
							<span>{{ normalizeText(landingTooltip.lp?.name || '登陆站') }}</span>
							<span class="pill" v-if="landingTooltip.lp?.country || landingTooltip.detail?.country">{{
								translateCountryToZh(normalizeText(landingTooltip.lp?.country ||
								landingTooltip.detail?.country)) }}</span>
						</div>
						<div class="row">
							<div class="key">经纬度</div>
							<div class="val">
								<span v-if="landingTooltip.lp?.coords && landingTooltip.lp.coords.length >= 2">Lon
									{{ Number(landingTooltip.lp.coords[0]).toFixed(2) }}, Lat {{
									Number(landingTooltip.lp.coords[1]).toFixed(2) }}</span>
								<span v-else>-</span>
							</div>
						</div>
															<div class="row">
																<div class="key">{{ t('局向') }}</div>
							<div class="val">{{ displayDirection(landingTooltip.lp?.direction ||
								landingTooltip.detail?.direction) }}</div>
						</div>
															<div class="row">
																<div class="key">{{ t('洲别') }}</div>
							<div class="val">{{ displayContinents(landingTooltip.lp?.continent ||
								landingTooltip.detail?.continent || landingTooltip.lp?.continentMacro ||
								landingTooltip.detail?.continentMacro) ||
								displayMacroRegion(landingTooltip.lp?.continent || landingTooltip.detail?.continent
								|| landingTooltip.lp?.continentMacro || landingTooltip.detail?.continentMacro) ||
								'-' }}</div>
						</div>
						<div class="row">
							<div class="key">关联海缆</div>
							<div class="val"><strong>{{ landingTooltip.detail?.cables?.length || 0 }}</strong> 条
							</div>
						</div>
						<div class="tooltip-list" v-if="tooltipLandingCables.length">
							<label class="chip" v-for="(cb, idx) in tooltipLandingCables" :key="cb.id || idx"
								@click.stop>
								<input type="checkbox" v-model="landingTooltip.selectedCableIds"
									:value="cb.id || cb.name" style="margin-right:6px;">
								<span class="name" @click.stop="focusCableByRef(cb)">{{ cb.name }}</span>
								<span class="meta">{{ cb.rfs_year || '-' }}<span class="planned" v-if="cb.is_planned"
										style="margin-left:6px;">规划中</span></span>
							</label>
						</div>
					</div>
					<div v-if="false && cableTooltip.show" ref="cableTooltip" class="tooltip-box"
						:style="[{ left: cableTooltip.left + 'px', top: cableTooltip.top + 'px' }, tooltipThemeStyle('cable', cableTooltip.line)]">
						<div class="title">
							<span class="pill" :style="typeThemeStyle('cable')">{{ t('海缆') }}</span>
							<span>{{ cableTooltip.line?.name || t('海缆') }}</span>
							<span class="pill" :class="cableTooltip.line?.ownershipClass"
								v-if="cableTooltip.line?.ownership">{{ t(cableTooltip.line?.ownership) }}</span>
						</div>
						<div class="row">
							<div class="key">{{ t('长度') }}</div>
							<div class="val">{{ cableTooltip.detail?.length || '-' }}</div>
						</div>
						<div class="row">
							<div class="key">{{ t('直线距离') }}</div>
							<div class="val">{{ cableTooltip.line?.km || 0 }} km</div>
						</div>
						<div class="row">
							<div class="key">{{ t('商用年') }}</div>
							<div class="val">{{ cableTooltip.detail?.rfs_year || '-' }}</div>
						</div>
							<div class="row">
								<div class="key">{{ t('局向') }}</div>
							<div class="val">{{ displayDirection(cableTooltip.line?.direction ||
								cableTooltip.detail?.direction) }}</div>
						</div>
							<div class="row">
								<div class="key">{{ t('洲别') }}</div>
							<div class="val">{{ displayContinents(cableTooltip.line?.continents ||
								cableTooltip.detail?.continents || cableTooltip.line?.continent ||
								cableTooltip.detail?.continent) || displayMacroRegion(cableTooltip.line?.continent
								|| cableTooltip.detail?.continent) || '-' }}</div>
						</div>
						<div class="row">
							<div class="key">{{ t('登陆点') }}</div>
							<div class="val"><strong>{{ landingCount(cableTooltip.detail || cableDetail.detail)
								}}</strong> {{ t('个') }}</div>
						</div>
						<div class="tooltip-list" v-if="tooltipCableLandings.length">
							<div class="chip" v-for="(lp, idx) in tooltipCableLandings" :key="lp.id || idx"
								@click.stop="focusLandingByRef(lp)">
								<span class="name">{{ lp.name }}</span>
								<span class="meta">{{ translateCountryToZh(normalizeText(lp.country || '-'))
									}}</span>
							</div>
						</div>
					</div>
				</div>
			</section>

			<!-- 浮动列表面板（可拖拽/缩放） -->
			<div v-if="floatingPanel.active" class="floating-panel" :style="{ left: floatingPanel.x + 'px', top: floatingPanel.y + 'px', width: floatingPanel.w + 'px', height: floatingPanel.h + 'px' }">
				<div class="fp-header" @mousedown.stop="startFpDrag">
					<div>
						<span v-if="floatingPanel.type==='cable'">{{ t('海缆列表') }}</span>
						<span v-else-if="floatingPanel.type==='landing'">{{ t('登陆站列表') }}</span>
						<span v-else-if="floatingPanel.type==='fault'">{{ t('故障列表') }}</span>
					</div>
					<div>
						<button class="inline-btn" @click.stop="closeFloating">{{ t('关闭') }}</button>
					</div>
				</div>
				<div class="fp-body" @mousemove.stop @mousedown.stop>
					<!-- 浮动：海缆列表 -->
					<div v-if="floatingPanel.type==='cable'">
						<div class="title-row with-search">
							<div class="searchbar" style="margin-left:auto;">
								<input type="text" v-model="searchCable" :placeholder="t('搜索海缆名称')" />
								<button v-if="searchCable" class="clear-btn" @click="searchCable=''">×</button>
							</div>
						</div>
						<div class="list">
							<div v-if="cablePageItems.length === 0" class="empty">{{ t('暂无数据') }}</div>
							<div v-else>
								<div v-for="(line, i) in cablePageItems" :key="(line.feature_id || line.id || line.name) + '-' + i">
									<div class="item" :class="{ expanded: cableDetail.id === line.id, active: (focusMode==='cable' && focusedCableId===line.id) }"
										 @click="onCableItemClick(line)"
										 @mouseenter="showCableTooltip(line, $event)" @mousemove="moveCableTooltip($event)" @mouseleave="hideCableTooltip">
										<div class="primary" style="gap:10px;">
											<span>{{ line.name }}</span>
												<span class="ownership-tag" :class="line.ownershipClass">{{ line.ownership ? t(line.ownership) : t('非权益') }}</span>
											<button class="inline-btn" @click.stop="toggleCableDetail(line)">{{ tWithLang('详情', getItemLang('cable', line.id)) }}</button>
										</div>
										<div class="badge" :class="{ ok: line.status==='ok', err: line.status==='err' }">{{ line.status==='ok' ? tWithLang('运行中', getItemLang('cable', line.id)) : tWithLang('故障', getItemLang('cable', line.id)) }}</div>
									</div>
									<div v-if="cableDetail.id === line.id" class="cable-detail">
										<div class="title">{{ line.name || tWithLang('海缆', getItemLang('cable', line.id)) }}
											<div>
												<button class="inline-btn" @click.stop="toggleItemLang('cable', line.id)">{{ getItemLang('cable', line.id) === 'zh' ? '中' : 'EN' }}</button>
												<button class="inline-btn" @click.stop="copyText(line.name || '', tWithLang('名称', getItemLang('cable', line.id)))">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
												<button class="inline-btn expand" @click.stop="openCableModal(line)">{{ tWithLang('展开', getItemLang('cable', line.id)) }}</button>
											</div>
										</div>
										<div class="rows">
											<div class="row"><div class="key">{{ tWithLang('编号', getItemLang('cable', line.id)) }}</div><div class="val">{{ line.id }}</div></div>
											<div class="row"><div class="key">{{ tWithLang('局向', getItemLang('cable', line.id)) }}</div><div class="val">{{ displayDirection(line.direction || cableDetail.detail?.direction) }}</div></div>
											<div class="row"><div class="key">{{ tWithLang('洲别', getItemLang('cable', line.id)) }}</div><div class="val">{{ displayContinents(line.continents || cableDetail.detail?.continents || line.continent || cableDetail.detail?.continent) || displayMacroRegion(line.continent || cableDetail.detail?.continent) || '-' }}</div></div>
											<div class="row" v-if="cableDetail.detail?.length"><div class="key">{{ tWithLang('长度', getItemLang('cable', line.id)) }}</div><div class="val">{{ cableDetail.detail.length }}</div></div>
											<div class="row" v-if="getCableUrl(line)"><div class="key">{{ tWithLang('官网', getItemLang('cable', line.id)) }}</div><div class="val"><button class="link-btn" @click.stop="openUrl(getCableUrl(line))">{{ tWithLang('官网', getItemLang('cable', line.id)) }}</button></div></div>
										</div>
										<div v-if="cableDetail.loading" style="color:#8aa4c4; margin-top:4px;">{{ tWithLang('详情加载中…', getItemLang('cable', line.id)) }}</div>
									</div>
								</div>
							</div>
						</div>
						<div class="list-footer">
							<div class="page-size" v-if="cablePaginationAdvanced">
								{{ t('每页') }}
								<select v-model.number="cablePageSize">
									<option :value="20">20</option>
									<option :value="50">50</option>
									<option :value="100">100</option>
								</select>
								{{ t('条') }}｜{{ t('共') }} {{ cableTotal }} {{ t('条') }}
							</div>
							<div class="actions">
								<button @click="prevCablePage" :disabled="cablePage <= 1">{{ t('上一页') }}</button>
								<button @click="nextCablePage" :disabled="cablePage >= cableTotalPages">{{ t('下一页') }}</button>
							</div>
							<div class="page-jump" v-if="cablePaginationAdvanced">
								{{ t('跳转') }}
								<input type="number" v-model.number="cablePageInput" @keyup.enter="goCablePage" min="1" :max="cableTotalPages" />
								<button @click="goCablePage">{{ t('Go') }}</button>
							</div>
							<label class="quick-toggle">
								<input type="checkbox" v-model="cablePaginationAdvanced" />
								{{ t('高级') }}
							</label>
							<div class="page-info">{{ t('第') }} {{ cablePage }} / {{ cableTotalPages }} {{ t('页') }}</div>
						</div>
					</div>
					<!-- 浮动：登陆站列表 -->
					<div v-else-if="floatingPanel.type==='landing'">
						<div class="title-row with-search">
							<div class="searchbar" style="margin-left:auto;">
								<input type="text" v-model="searchLanding" :placeholder="t('搜索登陆站坐标或名称')" />
								<button v-if="searchLanding" class="clear-btn" @click="searchLanding=''">×</button>
							</div>
						</div>
						<div class="list">
							<div v-if="landingPageItems.length === 0" class="empty">{{ t('暂无数据') }}</div>
							<div v-else>
								<div v-for="(lp, i) in landingPageItems" :key="lp.coordStr + i">
									<div class="item" :class="{ expanded: landingDetail.id === lp.id, active: (focusMode==='landing' && focusedLanding && focusedLanding.id===lp.id) }"
										 @click="onLandingItemClick(lp)"
										 @mouseenter="showLandingTooltip(lp, $event)" @mousemove="moveLandingTooltip($event)" @mouseleave="hideLandingTooltip">
										<div class="primary">
											<span>{{ normalizeText(lp.name || ('登陆站 ' + (i+1))) }}</span>
											<span class="ownership-tag" :class="lp.ownershipClass">{{ lp.ownership ? t(lp.ownership) : t('非权益') }}</span>
											<button class="inline-btn" @click.stop="toggleLandingDetail(lp)">{{ t('详情') }}</button>
										</div>
										<div class="badge">{{ displayCountryLabel(lp.country || t('未标注'), getItemLang('landing', lp.id)) }}</div>
									</div>
									<div v-if="landingDetail.id === lp.id" class="landing-detail">
										<div class="title">{{ normalizeText(lp.name || '登陆站') }}
											<div>
												<button class="inline-btn" @click.stop="toggleItemLang('landing', lp.id)">{{ getItemLang('landing', lp.id) === 'zh' ? '中' : 'EN' }}</button>
												<button class="inline-btn" @click.stop="copyText(lp.name || '', tWithLang('名称', getItemLang('landing', lp.id)))">{{ tWithLang('复制', getItemLang('landing', lp.id)) }}</button>
												<button class="inline-btn" @click.stop="copyText(lp.coordStr || '', tWithLang('坐标', getItemLang('landing', lp.id)))">{{ tWithLang('复制', getItemLang('landing', lp.id)) }}</button>
												<button class="inline-btn expand" @click.stop="openLandingModal(lp)">{{ tWithLang('展开', getItemLang('landing', lp.id)) }}</button>
											</div>
										</div>
										<div class="rows">
											<div class="row">
												<div class="key">{{ tLabel('coords','landing', lp.id) }}</div>
												<div class="val">
													<span v-if="lp.coords && lp.coords.length >= 2">Lon {{ Number(lp.coords[0]).toFixed(3) }}, Lat {{ Number(lp.coords[1]).toFixed(3) }}</span>
													<button class="inline-btn" @click.stop="copyText(lp.coordStr || '', '坐标')">{{ t('复制') }}</button>
													<span v-else>-</span>
												</div>
											</div>
											<div class="row" v-if="lp.id">
												<div class="key">{{ tLabel('id','landing', lp.id) }}</div>
												<div class="val">{{ lp.id }}</div>
											</div>
											<div class="row" v-if="lp.is_tbd !== undefined">
												<div class="key">{{ tLabel('is_tbd','landing', lp.id) }}</div>
												<div class="val">{{ lp.is_tbd ? (getItemLang('landing', lp.id) === 'zh' ? '是' : 'Yes') : (getItemLang('landing', lp.id) === 'zh' ? '否' : 'No') }}</div>
											</div>
											<div class="row" v-if="landingDetail.detail?.country || lp.country">
												<div class="key">{{ tLabel('country','landing', lp.id) }}</div>
												<div class="val">{{ translateCountryToZh(normalizeText(landingDetail.detail?.country || lp.country)) }}</div>
											</div>
											<div class="row">
												<div class="key">{{ tWithLang('局向', getItemLang('landing', lp.id)) }}</div>
												<div class="val">{{ displayDirection(lp.direction || landingDetail.detail?.direction) }}</div>
											</div>
											<div class="row">
												<div class="key">{{ tWithLang('洲别', getItemLang('landing', lp.id)) }}</div>
												<div class="val">{{ displayContinents(lp.continent || landingDetail.detail?.continent || lp.continentMacro || landingDetail.detail?.continentMacro) || displayMacroRegion(lp.continent || landingDetail.detail?.continent || lp.continentMacro || landingDetail.detail?.continentMacro) || '-' }}</div>
											</div>
											<div class="row clickable" @click.stop="setLandingCableLimit('all')">
												<div class="key">{{ tLabel('cables','landing', lp.id) }}</div>
												<div class="val inline-flex">{{ landingDetail.detail?.cables?.length || 0 }} {{ unitLabel('条', getItemLang('landing', lp.id)) }} <span v-if="landingDetail.loading">（{{ tWithLang('加载中…', getItemLang('landing', lp.id)) }}）</span>
													<select v-if="landingDetail.detail?.cables?.length" v-model="landingDetail.cableLimit" @click.stop class="mini-select">
														<option :value="8">{{ tWithLang('前 8 条', getItemLang('landing', lp.id)) }}</option>
														<option :value="15">{{ tWithLang('前 15 条', getItemLang('landing', lp.id)) }}</option>
														<option value="all">{{ tWithLang('全部', getItemLang('landing', lp.id)) }}</option>
													</select>
												</div>
											</div>
										</div>
										<div v-if="landingDetail.detail?.cables?.length" class="lines indent-lines">
											<div class="line" v-for="(cb, idx) in landingCableLimited" :key="cb.id || idx" style="cursor:pointer; align-items:center; gap:8px;" @click.stop="focusCableByRef(cb)">
												<span class="name">{{ normalizeText(cb.name) }}</span>
												<span class="meta">{{ t('商用年') }} {{ cb.rfs_year || '-' }} <span class="planned" v-if="cb.is_planned">{{ t('规划中') }}</span></span>
											</div>
										</div>
										<div v-if="landingDetail.loading" style="color:#8aa4c4; margin-top:4px;">{{ t('详情加载中…') }}</div>
									</div>
								</div>
							</div>
						</div>
						<div class="list-footer">
							<div class="page-size" v-if="landingPaginationAdvanced">
								{{ t('每页') }}
								<select v-model.number="landingPageSize">
									<option :value="20">20</option>
									<option :value="50">50</option>
									<option :value="100">100</option>
								</select>
								{{ t('条') }}｜{{ t('共') }} {{ landingTotal }} {{ t('条') }}
							</div>
							<div class="actions">
								<button @click="prevLandingPage" :disabled="landingPage <= 1">{{ t('上一页') }}</button>
								<button @click="nextLandingPage" :disabled="landingPage >= landingTotalPages">{{ t('下一页') }}</button>
							</div>
							<div class="page-jump" v-if="landingPaginationAdvanced">
								{{ t('跳转') }}
								<input type="number" v-model.number="landingPageInput" @keyup.enter="goLandingPage" min="1" :max="landingTotalPages" />
								<button @click="goLandingPage">{{ t('Go') }}</button>
							</div>
							<label class="quick-toggle">
								<input type="checkbox" v-model="landingPaginationAdvanced" />
								{{ t('高级') }}
							</label>
							<div class="page-info">{{ t('第') }} {{ landingPage }} / {{ landingTotalPages }} {{ t('页') }}</div>
						</div>
					</div>
					<!-- 浮动：故障列表 -->
					<div v-else-if="floatingPanel.type==='fault'">
						<div class="title-row with-search faults-header" style="flex-wrap:wrap; gap:10px;">
							<div style="display:flex; align-items:center; gap:10px; flex:1 1 auto; min-width:260px;">
								<h3 style="margin: 0;">{{ t('故障列表') }}</h3>
								<label class="quick-toggle" style="white-space:nowrap;">
									<input type="checkbox" v-model="faultOnlyOnMap" @change="updateChart" />
									{{ t('仅显示故障') }}
								</label>
								<label class="quick-toggle" style="white-space:nowrap;">
									<input type="checkbox" v-model="showFaultCablesOnMap" @change="updateChart" />
									{{ t('地图显示所有故障海缆') }}
								</label>
							</div>
							<div class="searchbar" style="flex:1 1 260px;">
								<input type="text" v-model="searchFault" :placeholder="t('搜索故障海缆')" />
								<button v-if="searchFault" class="clear-btn" @click="searchFault=''">×</button>
							</div>
						</div>
						<div class="list" ref="faultList">
							<div v-if="faultsLoading" class="empty loading">
								<span class="spinner" aria-hidden="true"></span>
								<span class="text">{{ t('故障加载中…') }}</span>
							</div>
							<div v-else-if="displayFaults.length === 0" class="empty">{{ t('暂无故障') }}</div>
							<div v-else>
								<div class="item" v-for="(f, i) in displayFaults" :key="f.name + i"
									 :class="{ active: i === selectedFaultIndex }" :ref="'faultItem-' + i"
									 @mouseenter="showFaultTooltip(f, $event)" @mousemove="moveFaultTooltip($event)" @mouseleave="hideFaultTooltip"
									 @click="selectFault(f, i)"
									 style="grid-template-columns: 1fr; align-items: flex-start; cursor: pointer; gap:6px;">
									<div class="primary" style="justify-content: space-between; width: 100%;">
										<div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
											<span style="font-weight:700;">{{ faultTitle(f) }}</span>
											<span v-if="faultSeverityLabel(f)" class="badge" :class="faultSeverityClass(f)">{{ faultSeverityLabel(f) }}</span>
										</div>
										<div style="display:flex; gap:6px; align-items:center;">
											<span class="badge err">{{ t('故障') }}</span>
											<button class="inline-btn" style="margin-left:8px;" @click.stop="toggleFaultDetail(i)">{{ selectedFaultIndex===i ? t('收起详情') : t('详情') }}</button>
										</div>
									</div>
									<div class="fault-meta-row">
										<span>{{ t('开始：') }}{{ safeVal(f.start) }}</span>
										<span>{{ t('结束：') }}{{ faultEndText(f) }}</span>
										<span class="pill workorder" v-if="f.workOrder">{{ t('工单') }} {{ safeVal(f.workOrder) }}</span>
										<span class="pill duration">{{ t('历时') }} {{ liveDuration(f) }}</span>
									</div>
									<!-- 拖动面板中也默认在条目下内联展开详情 -->
									<div v-if="faultPanelExpanded && selectedFaultIndex===i && !faultOverlayMode" class="fault-detail inline">
										<div class="title">
											<span>{{ faultTitle(f) }}</span>
											<div class="chips">
												<span class="badge err">{{ t('故障') }}</span>
												<span v-if="faultSeverityLabel(f)" class="badge" :class="faultSeverityClass(f)">{{ faultSeverityLabel(f) }}</span>
												<span class="pill duration">{{ t('历时') }} {{ liveDuration(f) }}</span>
											</div>
										</div>
										<div class="fault-meta-grid loc-grid">
											<div class="fault-meta-card loc-1">
												<div class="label">{{ t('故障定位1') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(1)">{{ faultEditState.active && faultEditState.index===1 ? t('编辑中') : t('编辑') }}</button></div>
												<div class="value fault-loc-card">
													<div class="fault-loc-main">
														<span class="fault-loc-landing">{{ safeVal(f.involvedLanding1) || t('未填站点') }}</span>
														<span class="fault-loc-distance">{{ safeVal(f.distance1) || '--' }} km</span>
													</div>
													<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(f.involvedCable1) || t('未填写') }}</div>
													<div class="fault-loc-remark" v-if="f.pointRemark1">{{ t('故障点备注1') }}：{{ f.pointRemark1 }}</div>
												</div>
											</div>
											<div class="fault-meta-card loc-2">
												<div class="label">{{ t('故障定位2') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(2)">{{ faultEditState.active && faultEditState.index===2 ? t('编辑中') : t('编辑') }}</button></div>
												<div class="value fault-loc-card">
													<div class="fault-loc-main">
														<span class="fault-loc-landing">{{ safeVal(f.involvedLanding2) || t('未填站点') }}</span>
														<span class="fault-loc-distance">{{ safeVal(f.distance2) || '--' }} km</span>
													</div>
													<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(f.involvedCable2) || t('未填写') }}</div>
													<div class="fault-loc-remark" v-if="f.pointRemark2">{{ t('故障点备注2') }}：{{ f.pointRemark2 }}</div>
												</div>
											</div>
											<div class="fault-meta-card highlight loc-3">
												<div class="label">{{ t('故障定位3') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(3)">{{ faultEditState.active && faultEditState.index===3 ? t('编辑中') : t('编辑') }}</button></div>
												<div class="value fault-loc-card">
													<div class="fault-loc-main">
														<span class="fault-loc-landing">{{ safeVal(f.involvedLanding3) || t('未填站点') }}</span>
														<span class="fault-loc-distance">{{ safeVal(f.distance3) || '--' }} km</span>
													</div>
													<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(f.involvedCable3) || t('未填写') }}</div>
													<div class="fault-loc-remark" v-if="f.pointRemark3">{{ t('故障点备注3') }}：{{ f.pointRemark3 }}</div>
												</div>
											</div>
										</div>
										<div class="fault-edit-overlay" v-if="isCompactMode && faultPanelExpanded && selectedFaultIndex===i && !faultOverlayMode && faultEditState.active" @click.stop>
											<div class="fault-edit-overlay-inner" :style="{ transform: 'translate(' + (faultOverlayState.dx||0) + 'px,' + (faultOverlayState.dy||0) + 'px)', overflow: 'auto' }" :title="t('按住标题可拖动，右下角可拖拉高宽')">
												<div class="overlay-header" @mousedown.stop="startFaultOverlayDrag">
													<span>{{ t('编辑故障定位') }} {{ faultEditState.index }}</span>
													<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('关闭') }}</button>
												</div>
												<div class="fault-edit-group compact">
													<el-select class="fault-edit-select" v-model="faultEditState.cable" filterable clearable :placeholder="t('选择或搜索故障定位海缆')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown" @change="onEditCableChange">
														<el-option v-for="nm in cableNameOptions" :key="nm" :label="nm" :value="nm"></el-option>
													</el-select>
													<el-select class="fault-edit-select" v-model="faultEditState.landing" filterable clearable :placeholder="t('选择或搜索登陆站（需先选海缆）')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown">
														<el-option v-for="nm in landingOptionsForEdit" :key="nm" :label="nm" :value="nm"></el-option>
													</el-select>
													<input class="fault-edit-input readonly" type="text" v-model="faultEditState.distance" :placeholder="t('距离 (km)')" readonly>
													<input class="fault-edit-input readonly" type="text" v-model="faultEditState.pointCoord" :placeholder="t('故障点经纬度 (Lon,Lat)')" readonly>
													<textarea class="fault-edit-input fault-remark-input" v-model="faultEditState.remark" :placeholder="t('故障点备注（可拖拽调整高宽）')" @input="autoResizeTextarea"></textarea>
													<div class="fault-edit-actions">
														<button class="inline-btn" @click.stop="startFaultPointPick()">{{ t('打点') }}</button>
														<button class="inline-btn" :disabled="faultEditState.saving" @click.stop="saveFaultEdit()">{{ t('保存') }}</button>
														<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('取消') }}</button>
													</div>
													<span class="meta err" v-if="faultEditState.error" style="color:#ff9f7f;">{{ faultEditState.error }}</span>
												</div>
											</div>
										</div>
										<div class="rows">
											<div class="row"><div class="key">{{ t('涉及海缆') }}</div><div class="val">{{ safeVal(f.cableName || f.name) }}</div></div>
											<div class="row"><div class="key">{{ t('故障描述') }}</div><div class="val">{{ safeVal(f.desc) }}</div></div>
											<div class="row"><div class="key">{{ t('故障原因') }}</div><div class="val">{{ safeVal(f.cause) }}</div></div>
											<div class="row"><div class="key">{{ t('处理进展') }}</div><div class="val">{{ safeVal(f.progress) }}</div></div>
											<div class="row"><div class="key">{{ t('最近一次修改者') }}</div><div class="val">{{ safeVal(f.lastModifier || (f.raw && f.raw['大屏最近一次操作用户'])) }}</div></div>
											<div class="row"><div class="key">{{ t('业务影响') }}</div><div class="val">{{ safeVal(f.impact) }}</div></div>
										</div>
										<div style="display:flex; justify-content:flex-end; gap:10px; margin-top:8px;">
											<button class="inline-btn" @click.stop="expandFaultOverlay()">{{ t('展开到大窗') }}</button>
											<button class="inline-btn" @click.stop="toggleFaultDetail(i)">{{ t('收起') }}</button>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div v-if="floatingPanel.type==='fault' && faultPanelExpanded && faultOverlayMode && selectedFault" class="compact-fault-overlay" style="position:absolute; inset:48px 10px 18px 10px;">
							<div class="fault-detail">
								<button class="close overlay-close" @click.stop="toggleFaultDetail(selectedFaultIndex)">×</button>
								<div class="title">
									<span>{{ faultTitle(selectedFault) }}</span>
									<div class="chips">
										<span class="badge err">{{ t('故障') }}</span>
											<span v-if="faultSeverityLabel(selectedFault)" class="badge" :class="faultSeverityClass(selectedFault)">{{ faultSeverityLabel(selectedFault) }}</span>
										<span class="pill duration">{{ t('历时') }} {{ liveDuration(selectedFault) }}</span>
									</div>
								</div>
								<div class="fault-meta-grid loc-grid">
									<div class="fault-meta-card loc-1">
										<div class="label">{{ t('故障定位1') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(1)">{{ faultEditState.active && faultEditState.index===1 ? t('编辑中') : t('编辑') }}</button></div>
										<div class="value fault-loc-card">
											<div class="fault-loc-main">
												<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding1) || t('未填站点') }}</span>
												<span class="fault-loc-distance">{{ safeVal(selectedFault.distance1) || '--' }} km</span>
											</div>
											<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable1) || t('未填写') }}</div>
											<div class="fault-loc-remark" v-if="selectedFault.pointRemark1">{{ t('故障点备注1') }}：{{ selectedFault.pointRemark1 }}</div>
										</div>
									</div>
									<div class="fault-meta-card loc-2">
										<div class="label">{{ t('故障定位2') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(2)">{{ faultEditState.active && faultEditState.index===2 ? t('编辑中') : t('编辑') }}</button></div>
										<div class="value fault-loc-card">
											<div class="fault-loc-main">
												<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding2) || t('未填站点') }}</span>
												<span class="fault-loc-distance">{{ safeVal(selectedFault.distance2) || '--' }} km</span>
											</div>
											<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable2) || t('未填写') }}</div>
											<div class="fault-loc-remark" v-if="selectedFault.pointRemark2">{{ t('故障点备注2') }}：{{ selectedFault.pointRemark2 }}</div>
										</div>
									</div>
									<div class="fault-meta-card highlight loc-3">
										<div class="label">{{ t('故障定位3') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(3)">{{ faultEditState.active && faultEditState.index===3 ? t('编辑中') : t('编辑') }}</button></div>
										<div class="value fault-loc-card">
											<div class="fault-loc-main">
												<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding3) || t('未填站点') }}</span>
												<span class="fault-loc-distance">{{ safeVal(selectedFault.distance3) || '--' }} km</span>
											</div>
											<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable3) || t('未填写') }}</div>
											<div class="fault-loc-remark" v-if="selectedFault.pointRemark3">{{ t('故障点备注3') }}：{{ selectedFault.pointRemark3 }}</div>
										</div>
									</div>
								</div>
								<div class="rows">
									<div class="row"><div class="key">{{ t('涉及海缆') }}</div><div class="val">{{ safeVal(selectedFault.cableName || selectedFault.name) }}</div></div>
									<div class="row"><div class="key">{{ t('故障描述') }}</div><div class="val">{{ safeVal(selectedFault.desc) }}</div></div>
									<div class="row"><div class="key">{{ t('是否重大') }}</div><div class="val">{{ safeVal(selectedFault.isMajor) }}</div></div>
									<div class="row"><div class="key">{{ t('故障原因') }}</div><div class="val">{{ safeVal(selectedFault.cause) }}</div></div>
									<div class="row"><div class="key">{{ t('处理进展') }}</div><div class="val">{{ safeVal(selectedFault.progress) }}</div></div>
									<div class="row"><div class="key">{{ t('最近一次修改者') }}</div><div class="val">{{ safeVal(selectedFault.lastModifier || (selectedFault.raw && selectedFault.raw['大屏最近一次操作用户'])) }}</div></div>
									<div class="row"><div class="key">{{ t('业务影响') }}</div><div class="val">{{ safeVal(selectedFault.impact) }}</div></div>
									<div class="row"><div class="key">{{ t('备注') }}</div><div class="val">{{ safeVal(selectedFault.remark) }}</div></div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="fp-resizer" @mousedown.stop="startFpResize"></div>
			</div>

			<!-- 紧凑模式：合并面板，悬浮在左侧，可收起 -->
			<div v-if="isCompactMode" class="compact-panel panel console-slim" :class="{ collapsed: compactCollapsed }" :style="{ width: compactPanelWidth + 'px' }">
				<!-- 紧凑模式收起/展开按钮：图标化，避免被父容器裁剪 -->
				<div class="compact-drawer-handle" @click="compactCollapsed = !compactCollapsed"
					:title="compactCollapsed ? t('展开控制台') : t('收起控制台')"
					:aria-label="compactCollapsed ? t('展开控制台') : t('收起控制台')">
					<i :class="compactCollapsed ? 'el-icon-arrow-right' : 'el-icon-arrow-left'" aria-hidden="true"></i>
				</div>
				<div class="compact-resizer" @mousedown="startCompactResize"></div>
						<div class="panel-header"
							style="padding: 12px 14px; display:flex; align-items:center; justify-content:space-between; gap:8px;">
						<div style="display:flex; align-items:center; gap:10px;"><span class="accent"></span>{{ t('控制台') }}</div>
						<div style="display:flex; gap:8px; align-items:center;">
							<button class="inline-btn" @click.stop="restartApp"><i class="el-icon-switch-button" aria-hidden="true" style="margin-right:4px;"></i>{{ t('重启') }}</button>
							<button class="inline-btn" @click.stop="resetAllFilters">{{ t('重置筛选') }}</button>
						</div>
						</div>
					<div class="panel-body custom-scroll-hidden" style="padding: 10px;">
							<div class="compact-tabs">
								<button class="tab-btn" :class="{ active: compactActiveTab==='overview' }"
									@click="setCompactTab('overview')">{{ t('概览/筛选') }}</button>
								<button class="tab-btn" :class="{ active: compactActiveTab==='cable' }"
									@click="setCompactTab('cable')">{{ t('海缆列表') }}</button>
								<button class="tab-btn" :class="{ active: compactActiveTab==='landing' }"
									@click="setCompactTab('landing')">{{ t('登陆站') }}</button>
								<button class="tab-btn" :class="{ active: compactActiveTab==='fault' }"
									@click="setCompactTab('fault')">{{ t('故障') }}</button>
							</div>
							<div class="compact-body">
								<div v-show="compactActiveTab==='overview'">
									<div class="overview">
										<div class="title"><span class="accent"></span>{{ t('中国移动海陆缆整体情况') }}</div>
										<div class="metrics">
											<div class="metric">
												<div class="label">{{ t('权益') }}</div>
												<div class="value">{{ formatG(overviewMetrics.equityTotal) }}</div>
											</div>
											<div class="metric">
												<div class="label">{{ t('点亮') }}</div>
												<div class="value">{{ formatG(overviewMetrics.lightUpBandwidthTotal) }}
												</div>
											</div>
											<div class="metric">
												<div class="label">{{ t('已用') }}</div>
												<div class="value">{{ formatG(overviewMetrics.usingBandwidthTotal) }}
												</div>
											</div>
											<div class="metric">
												<div class="label">{{ t('海陆缆总长') }}</div>
												<div class="value">{{ formatKm(overviewMetrics.lengthTotal) }}</div>
											</div>
											<div class="metric">
												<div class="label">{{ t('利用率') }}</div>
												<div class="value">{{
													formatPercent(overviewMetrics.utilizationRateTotal) }}</div>
											</div>
											<div class="metric">
												<div class="label">{{ t('业务总数') }}</div>
												<div class="value">{{ formatInt(overviewMetrics.businessesTotal) }}
												</div>
											</div>
										</div>
										<div class="regions">
											<label class="chip" v-for="r in ['美国','欧洲','亚太','澳洲','其他']" :key="r">
												<input type="radio" name="overviewRegionCompact" :value="r"
													v-model="overviewRegion"> {{ t(r) }}
											</label>
										</div>
									</div>
									<div class="controls">
										<div class="block">
											<div
												style="display:flex; align-items:center; justify-content:space-between; gap:8px; flex-wrap:wrap;">
												<h3>{{ t('筛选') }}
													<label class="inline-btn"
														style="display:inline-flex; align-items:center; gap:6px;">
														<input type="checkbox" v-model="showCables"
															@change="updateChart"> {{ t('海缆') }}
													</label>
													<label class="inline-btn"
														style="display:inline-flex; align-items:center; gap:6px;">
														<input type="checkbox" v-model="showLandings"
															@change="updateChart"> {{ t('登陆站') }}
													</label>
												</h3>
												<div style="display:flex; gap:6px; flex-wrap:wrap;">
													<button class="inline-btn"
														@click.stop="selectAllOwnerships">{{ t('权益全选') }}</button>
													<button class="inline-btn"
														@click.stop="selectAllTypes">{{ t('类型全选') }}</button>
												</div>
											</div>
											<div class="filters" style="margin-top:6px;">
												<label class="ownership-self">
													<input type="checkbox" value="自建" v-model="selectedOwnerships"> {{ t('自建') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyOwnership('自建')">{{ t('只选') }}</span>
												</label>
												<label class="ownership-co">
													<input type="checkbox" value="合建" v-model="selectedOwnerships"> {{ t('合建') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyOwnership('合建')">{{ t('只选') }}</span>
												</label>
												<label class="ownership-rent">
													<input type="checkbox" value="租用" v-model="selectedOwnerships"> {{ t('租用') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyOwnership('租用')">{{ t('只选') }}</span>
												</label>
												<label class="ownership-none">
													<input type="checkbox" value="非权益" v-model="selectedOwnerships"> {{ t('非权益') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyOwnership('非权益')">{{ t('只选') }}</span>
												</label>

												<label><input type="checkbox" value="跨太平洋" v-model="selectedTypes"> {{ t('跨太平洋') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyType('跨太平洋')">{{ t('只选') }}</span></label>
												<label><input type="checkbox" value="亚欧互联" v-model="selectedTypes"> {{ t('亚欧互联') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyType('亚欧互联')">{{ t('只选') }}</span></label>
												<label><input type="checkbox" value="区域互联" v-model="selectedTypes"> {{ t('区域互联') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyType('区域互联')">{{ t('只选') }}</span></label>
												<label><input type="checkbox" value="其他" v-model="selectedTypes"> {{ t('其他') }}
													<span class="only-btn"
														@click.stop.prevent="selectOnlyType('其他')">{{ t('只选') }}</span></label>
											</div>
											<div class="filters range"
												style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
												<label style="flex:1 1 48%;">{{ t('洲别') }}
													<select v-model="scopeContinent">
														<option value="all">{{ t('全部') }}</option>
														<option value="APAC">{{ t('亚太') }}</option>
														<option value="EMEA">{{ t('欧洲中东非') }}</option>
														<option value="AMER">{{ t('美洲') }}</option>
													</select>
												</label>
												<label style="flex:1 1 48%;">{{ t('距离') }}
													<select v-model="scopeDistance">
														<option value="all">{{ t('不限') }}</option>
														<option value=">5000">{{ t('大于 5000km') }}</option>
														<option value="<5000">{{ t('小于 5000km') }}</option>
													</select>
												</label>
											</div>
										</div>
									</div>

									<div class="title stats-title"><span class="accent"></span>{{ t('中国移动海缆整体情况') }}</div>
									<div class="console-stats compact" style="margin-top:10px;">
										<div class="stat stat-hero">
											<div class="stat-head">
												<span class="stat-chip pulse">{{ t('实时') }}</span>
												<span class="stat-title">{{ t('海缆') }}</span>
											</div>
											<div class="stat-number">{{ stats.totalCables }}</div>
											<div class="stat-subline">{{ t('运行中') }} {{ stats.okCount }} ｜ {{ t('故障') }} <span class="stat-fault">{{ faultCount }}</span></div>
										</div>
										<div class="stat">
											<div class="stat-head">
												<span class="stat-chip">{{ t('覆盖') }}</span>
												<span class="stat-title">{{ t('登陆站') }}</span>
											</div>
											<div class="stat-number">{{ stats.totalLandings }}</div>
											<div class="stat-subline">{{ t('权益') }} {{ stats.ownedLandings }}</div>
										</div>
										<div class="stat">
											<div class="stat-head">
												<span class="stat-chip ghost">{{ t('资产') }}</span>
												<span class="stat-title">{{ t('权益海缆') }}</span>
											</div>
											<div class="stat-number">{{ stats.ownedCables }}</div>
											<div class="stat-grid">
												<span>{{ t('自建') }} {{ stats.selfCables }}</span>
												<span>{{ t('合建') }} {{ stats.coCables }}</span>
												<span>{{ t('租用') }} {{ stats.rentCables }}</span>
											</div>
										</div>
									</div>
								</div>

								<div v-show="compactActiveTab==='cable'">
									<div class="list-block" style="margin-top:6px;">
										<div class="title-row with-search">
											<h3 style="margin: 0;">{{ t('海缆列表') }}</h3>
											<div class="searchbar">
												<input type="text" v-model="searchCable" :placeholder="t('搜索海缆名称')" />
												<button v-if="searchCable" class="clear-btn"
													@click="searchCable=''">×</button>
											</div>
										</div>
										<div class="list">
											<div v-if="cablePageItems.length === 0" class="empty">{{ t('暂无数据') }}</div>
											<div v-else>
												<div v-for="(line, i) in cablePageItems"
													:key="(line.feature_id || line.id || line.name) + '-' + i">
													<div class="item"
														:class="{ expanded: cableDetail.id === line.id, active: (focusMode==='cable' && focusedCableId===line.id) }"
														@click="onCableItemClick(line)"
														@mouseenter="showCableTooltip(line, $event)"
														@mousemove="moveCableTooltip($event)"
														@mouseleave="hideCableTooltip">
														<div class="primary" style="gap:10px;">
															<span>{{ line.name }}</span>
															<span class="ownership-tag" :class="line.ownershipClass">{{
																	line.ownership ? t(line.ownership) : t('非权益') }}</span>
															<button class="inline-btn"
																@click.stop="toggleCableDetail(line)">{{ t('详情') }}</button>
														</div>
														<div class="badge" :class="{ ok: !isCableFaulted(line), err: isCableFaulted(line) }">
															{{ isCableFaulted(line) ? t('中断') : t('运行中') }}
														</div>
													</div>
													<div v-if="cableDetail.id === line.id" class="cable-detail">
														<div class="title">{{ line.name || '海缆' }}
															<div>
																<button class="inline-btn"
																	@click.stop="toggleItemLang('cable', line.id)">{{
																	getItemLang('cable', line.id) === 'zh' ? '中' : 'EN'
																	}}</button>
																<button class="inline-btn"
																	@click.stop="copyText(line.name || '', getItemLang('cable', line.id) === 'zh' ? '名称' : 'Name')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
																<button class="inline-btn"
																	@click.stop="toggleShowLandingLabels()"
																	style="display:none;">{{ showLandingLabels ?
																	t('隐藏登陆站名') : t('显示登陆站名') }}</button>
																<button class="inline-btn expand"
																	@click.stop="openCableModal(line)">{{ tWithLang('展开', getItemLang('cable', line.id)) }}</button>
															</div>
														</div>
														<div class="rows">
															<div class="row">
																<div class="key">{{ tLabel('branch','cable', line.id) }}
																</div>
																<div class="val">{{ t('敬请期待') }}</div>
															</div>
															<div class="row">
																<div class="key">{{ tLabel('name','cable', line.id) }}
																</div>
																<div class="val">{{ line.name }} <button
																		class="inline-btn"
																		@click.stop="copyText(line.name || '', getItemLang('cable', line.id) === 'zh' ? '名称' : 'Name')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
																</div>
															</div>
															<div class="row">
																<div class="key">{{ tLabel('id','cable', line.id) }}
																</div>
																<div class="val">{{ line.id }} <button
																		class="inline-btn"
																		@click.stop="copyText(line.id || '', getItemLang('cable', line.id) === 'zh' ? '编号' : 'ID')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
																</div>
															</div>
															<div class="row">
																<div class="key">{{ tLabel('feature_id','cable',
																	line.id) }}</div>
																<div class="val">{{ line.feature_id || '-' }} <button
																		class="inline-btn"
																		@click.stop="copyText(line.feature_id || '', 'feature_id')">{{ tWithLang('复制', getItemLang('cable', line.id)) }}</button>
																</div>
															</div>
															<div class="row">
																<div class="key">{{ tLabel('ownership','cable', line.id)
																	}}</div>
																<div class="val">{{ line.ownership ? t(line.ownership) : t('非权益') }}</div>
															</div>
															<div class="row">
																<div class="key">{{ tWithLang('局向', getItemLang('cable', line.id)) }}</div>
																<div class="val">{{ displayDirection(line.direction ||
																	cableDetail.detail?.direction) }}</div>
															</div>
															<div class="row">
																<div class="key">{{ tWithLang('洲别', getItemLang('cable', line.id)) }}</div>
																<div class="val">{{ displayContinents(line.continents ||
																	cableDetail.detail?.continents || line.continent ||
																	cableDetail.detail?.continent) ||
																	displayMacroRegion(line.continent ||
																	cableDetail.detail?.continent) || '-' }}</div>
															</div>
															<div class="row">
																<div class="key">{{ tLabel('rfs_year','cable', line.id)
																	}}</div>
																<div class="val">{{ cableDetail.detail?.rfs_year || '-'
																	}}</div>
															</div>
															<div class="row">
																<div class="key">{{ tLabel('is_planned','cable',
																	line.id) }}</div>
																<div class="val">{{ cableDetail.detail?.is_planned ?
																	(getItemLang('cable', line.id) === 'zh' ? '是' :
																	'Yes') : (getItemLang('cable', line.id) === 'zh' ?
																	'否' : 'No') }}</div>
															</div>
															<div class="row" v-if="cableDetail.detail?.length">
																<div class="key">{{ tLabel('length','cable', line.id) }}
																</div>
																<div class="val">{{ cableDetail.detail.length }}</div>
															</div>
															<div class="row" v-if="getCableUrl(line)">
																<div class="key">{{ tLabel('website','cable', line.id)
																	}}</div>
																<div class="val"><button class="link-btn"
																	@click.stop="openUrl(getCableUrl(line))">{{ tWithLang('官网', getItemLang('cable', line.id)) }}</button>
																</div>
															</div>
															<div class="row"
																v-if="cableDetail.detail?.owners || cableDetail.detail?.owner">
																<div class="key">{{ tLabel('owners','cable', line.id) }}
																</div>
																<div class="val"><span class="owner-text"
																		:class="{ expanded: isExpanded(line.id, 'owners') }"
																		@click.stop="toggleExpand(line.id, 'owners')"><template
																			v-if="isExpanded(line.id, 'owners')">{{
																			displayOwnerText(line.id)
																			}}</template><template v-else>{{
																			displayOwnerText(line.id) }}<span
																				v-if="needsOwnerEllipsis(line.id)"
																				class="owner-ell">…</span></template></span>
																</div>
															</div>
															<div class="row" v-if="cableDetail.detail?.suppliers">
																<div class="key">{{ tLabel('suppliers','cable', line.id)
																	}}</div>
																<div class="val">{{
																	translateEntities(cableDetail.detail.suppliers,
																	getItemLang('cable', line.id)) }}</div>
															</div>
															<div class="row">
																<div class="key">{{ tLabel('landings','cable', line.id)
																	}}</div>
																<div class="val">
																	<div class="inline-flex">
																		<span class="meta-count">{{
																			landingCount(cableDetail.detail) }} {{ unitLabel('个', getItemLang('cable', line.id)) }}</span>
																		<select
																			v-if="landingCount(cableDetail.detail) > 0"
																			v-model="cableDetail.landingLimit"
																			@click.stop class="mini-select">
																			<option :value="8">{{ tWithLang('前 8 条', getItemLang('cable', line.id)) }}</option>
																			<option :value="15">{{ tWithLang('前 15 条', getItemLang('cable', line.id)) }}</option>
																			<option value="all">{{ tWithLang('全部', getItemLang('cable', line.id)) }}</option>
																		</select>
																	</div>
																	<div v-if="landingCount(cableDetail.detail) > 0"
																		class="lines indent-lines"
																		style="margin-top:6px;">
																		<div class="line"
																			v-for="(lp,i2) in cableLandingLimited()"
																			:key="lp.id || i2"
																			@click.stop="focusLandingByRef(lp)">
																			<span class="name">{{ normalizeText(lp.name)
																				}}</span>
																			<span class="meta" v-if="lp.country">{{
																				displayCountryLabel(lp.country, getItemLang('landing', lp.id || lp.name || ''))
																				}}</span>
																		</div>
																		<div class="more"
																			v-if="landingCount(cableDetail.detail) > cableLandingVisibleCount()">
																			{{ tWithLang('等', getItemLang('cable', line.id)) }} {{ landingCount(cableDetail.detail) -
																			cableLandingVisibleCount() }} {{ unitLabel('条', getItemLang('cable', line.id)) }}…</div>
																	</div>
																	<span v-else>{{ t('暂无') }}</span>
																</div>
															</div>
														</div>

														<div v-if="cableDetail.loading"
															style="color:#8aa4c4; margin-top:4px;">{{ tWithLang('详情加载中…', getItemLang('cable', line.id)) }}</div>
													</div>
												</div>
											</div>
										</div>
										<div class="list-footer">
											<div class="page-size" v-if="cablePaginationAdvanced">
												{{ t('每页') }}
												<select v-model.number="cablePageSize">
													<option :value="20">20</option>
													<option :value="50">50</option>
													<option :value="100">100</option>
												</select>
												{{ t('条') }}｜{{ t('共') }} {{ cableTotal }} {{ t('条') }}
											</div>
											<div class="actions">
												<button @click="prevCablePage" :disabled="cablePage <= 1">{{ t('上一页') }}</button>
												<button @click="nextCablePage"
													:disabled="cablePage >= cableTotalPages">{{ t('下一页') }}</button>
											</div>
											<div class="page-jump" v-if="cablePaginationAdvanced">
												跳转
												<input type="number" v-model.number="cablePageInput"
													@keyup.enter="goCablePage" min="1" :max="cableTotalPages" />
												<button @click="goCablePage">Go</button>
											</div>
											<label class="quick-toggle">
												<input type="checkbox" v-model="cablePaginationAdvanced" />
												高级
											</label>
											<div class="page-info">{{ t('第') }} {{ cablePage }} / {{ cableTotalPages }} {{ t('页') }}</div>
										</div>
									</div>
								</div>

								<div v-show="compactActiveTab==='landing'">
									<div class="list-block" style="margin-top:6px;">
										<div class="title-row with-search">
											<h3 style="margin: 0;">{{ t('登陆站列表') }}</h3>
											<div class="searchbar">
												<input type="text" v-model="searchLanding" :placeholder="t('搜索登陆站坐标或名称')" />
												<button v-if="searchLanding" class="clear-btn"
													@click="searchLanding=''">×</button>
											</div>
											
										</div>
										<div class="list">
											<div v-if="landingPageItems.length === 0" class="empty">{{ t('暂无数据') }}</div>
											<div v-else>
												<div v-for="(lp, i) in landingPageItems" :key="lp.coordStr + i">
													<div class="item"
														:class="{ expanded: landingDetail.id === lp.id, active: (focusMode==='landing' && focusedLanding && focusedLanding.id===lp.id) }"
														@click="onLandingItemClick(lp)"
														@mouseenter="showLandingTooltip(lp, $event)"
														@mousemove="moveLandingTooltip($event)"
														@mouseleave="hideLandingTooltip" :title="t('点击聚焦')">
														<div class="primary">
															<!-- <span class="expand-ico"></span> -->
															<span>{{ normalizeText(lp.name || ('登陆站 ' + (i+1)))
																}}</span>
															<span class="ownership-tag" :class="lp.ownershipClass">{{
																lp.ownership ? t(lp.ownership) : t('非权益') }}</span>
															<span class="badge" :class="isLandingInvolved(lp) ? 'warn' : 'ok'" style="margin-left:6px;">{{ isLandingInvolved(lp) ? t('涉及故障') : t('运行中') }}</span>
															<button class="inline-btn"
																@click.stop="toggleLandingDetail(lp)">{{ t('详情') }}</button>
														</div>
														<div class="badge">{{ displayCountryLabel(lp.country || t('未标注'), getItemLang('landing', lp.id)) }}
														</div>
													</div>
													<div v-if="landingDetail.id === lp.id" class="landing-detail">
														<div class="title">{{ normalizeText(lp.name || '登陆站') }}
															<div>
																<button class="inline-btn"
																	@click.stop="toggleItemLang('landing', lp.id)">{{
																	getItemLang('landing', lp.id) === 'zh' ? '中' : 'EN'
																	}}</button>
																<button class="inline-btn"
																	@click.stop="copyText(lp.name || '', '名称')">{{ t('复制') }}</button>
																<button class="inline-btn"
																	@click.stop="toggleShowLandingLabels()"
																	style="display:none;">{{ showLandingLabels ?
																	t('隐藏登陆站名') : t('显示登陆站名') }}</button>
																<button class="inline-btn expand"
																	@click.stop="openLandingModal(lp)">{{ t('展开') }}</button>
															</div>
														</div>
														<div class="rows">
															<div class="row">
																<div class="key">{{ tLabel('coords','landing', lp.id) }}
																</div>
																<div class="val">
																	<span v-if="lp.coords && lp.coords.length >= 2">Lon
																		{{ Number(lp.coords[0]).toFixed(3) }}, Lat {{
																		Number(lp.coords[1]).toFixed(3) }}</span>
																	<button class="inline-btn"
																		@click.stop="copyText(lp.coordStr || '', '坐标')">{{ t('复制') }}</button>
																	<span v-else>-</span>
																</div>
															</div>
															<div class="row" v-if="lp.id">
																<div class="key">{{ tLabel('id','landing', lp.id) }}
																</div>
																<div class="val">{{ lp.id }}</div>
															</div>
															<div class="row" v-if="lp.is_tbd !== undefined">
																<div class="key">{{ tLabel('is_tbd','landing', lp.id) }}
																</div>
																<div class="val">{{ lp.is_tbd ? (getItemLang('landing',
																	lp.id) === 'zh' ? '是' : 'Yes') :
																	(getItemLang('landing', lp.id) === 'zh' ? '否' :
																	'No') }}</div>
															</div>
															<div class="row"
																v-if="landingDetail.detail?.country || lp.country">
																<div class="key">{{ tLabel('country','landing', lp.id)
																	}}</div>
																<div class="val">{{
																	translateCountryToZh(normalizeText(landingDetail.detail?.country
																	|| lp.country)) }}</div>
															</div>
															<div class="row">
																<div class="key">{{ tWithLang('局向', getItemLang('landing', lp.id)) }}</div>
																<div class="val">{{ displayDirection(lp.direction ||
																	landingDetail.detail?.direction) }}</div>
															</div>
															<div class="row">
																<div class="key">{{ tWithLang('洲别', getItemLang('landing', lp.id)) }}</div>
																<div class="val">{{ displayContinents(lp.continent ||
																	landingDetail.detail?.continent || lp.continentMacro
																	|| landingDetail.detail?.continentMacro) ||
																	displayMacroRegion(lp.continent ||
																	landingDetail.detail?.continent || lp.continentMacro
																	|| landingDetail.detail?.continentMacro) || '-' }}
																</div>
															</div>
															<div class="row clickable"
																@click.stop="setLandingCableLimit('all')">
																<div class="key">{{ tLabel('cables','landing', lp.id) }}
																</div>
																<div class="val inline-flex">{{
																	landingDetail.detail?.cables?.length || 0 }} {{ unitLabel('条', getItemLang('landing', lp.id)) }} <span
																	v-if="landingDetail.loading">（{{ tWithLang('加载中…', getItemLang('landing', lp.id)) }}）</span>
																	<select v-if="landingDetail.detail?.cables?.length"
																		v-model="landingDetail.cableLimit" @click.stop
																		class="mini-select">
																		<option :value="8">{{ tWithLang('前 8 条', getItemLang('landing', lp.id)) }}</option>
																		<option :value="15">{{ tWithLang('前 15 条', getItemLang('landing', lp.id)) }}</option>
																		<option value="all">{{ tWithLang('全部', getItemLang('landing', lp.id)) }}</option>
																	</select>
																</div>
															</div>
														</div>
														<div v-if="landingDetail.detail?.cables?.length"
															class="lines indent-lines">
															<div class="line" v-for="(cb, idx) in landingCableLimited"
																:key="cb.id || idx"
																style="cursor:pointer; align-items:center; gap:8px;"
																@click.stop="focusCableByRef(cb)">
																<span class="name">{{ normalizeText(cb.name) }}</span>
																<span class="meta">{{ t('商用年') }} {{ cb.rfs_year || '-' }} <span
																	class="planned"
																	v-if="cb.is_planned">{{ t('规划中') }}</span></span>
															</div>
															<div class="more"
																v-if="landingDetail.detail.cables.length > landingCableVisibleCount">
																{{ tWithLang('等', getItemLang('landing', lp.id)) }} {{ landingDetail.detail.cables.length -
																landingCableVisibleCount }} {{ unitLabel('条', getItemLang('landing', lp.id)) }}…</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="list-footer">
											<div class="page-size" v-if="landingPaginationAdvanced">
												每页
												<select v-model.number="landingPageSize">
													<option :value="20">20</option>
													<option :value="50">50</option>
													<option :value="100">100</option>
												</select>
												{{ t('条') }}｜{{ t('共') }} {{ landingTotal }} {{ t('条') }}
											</div>
											<div class="actions">
												<button @click="prevLandingPage"
													:disabled="landingPage <= 1">{{ t('上一页') }}</button>
												<button @click="nextLandingPage"
													:disabled="landingPage >= landingTotalPages">{{ t('下一页') }}</button>
											</div>
											<div class="page-jump" v-if="landingPaginationAdvanced">
												{{ t('跳转') }}
												<input type="number" v-model.number="landingPageInput"
													@keyup.enter="goLandingPage" min="1" :max="landingTotalPages" />
												<button @click="goLandingPage">{{ t('Go') }}</button>
											</div>
											<label class="quick-toggle">
												<input type="checkbox" v-model="landingPaginationAdvanced" />
												{{ t('高级') }}
											</label>
											<div class="page-info">{{ t('第') }} {{ landingPage }} / {{ landingTotalPages }} {{ t('页') }}</div>
										</div>
									</div>
								</div>

								<div v-show="compactActiveTab==='fault'">
									<div class="list-block" style="margin-top:6px;">
										<div class="title-row compact-fault-header">
											<div class="row-top">
												<h3 style="margin:0;">{{ t('故障列表') }}</h3>
												<div class="fault-stats">
													<span v-if="faultStats.major" class="badge major">{{ t('重大') }} {{ faultStats.major }}</span>
													<span v-if="faultStats.important" class="badge important">{{ t('重要') }} {{ faultStats.important }}</span>
													<span>{{ t('共') }} {{ faultStats.total }} {{ t('条') }}</span>
												</div>
											</div>
											<div class="row-bottom">
												<div class="searchbar">
													<input type="text" v-model="searchFault" :placeholder="t('搜索故障海缆')" />
													<button v-if="searchFault" class="clear-btn" @click="searchFault=''">×</button>
												</div>
												<label class="quick-toggle">
													<input type="checkbox" v-model="faultOnlyOnMap" @change="updateChart" />
													{{ t('仅显示故障') }}
												</label>
												<label class="quick-toggle">
													<input type="checkbox" v-model="showFaultCablesOnMap" @change="updateChart" />
													{{ t('地图显示所有故障海缆') }}
												</label>
												<button class="inline-btn" @click="toggleRealtime" style="margin-left:8px;">
													{{ realtimeEnabled ? t('关闭实况') : t('开启实况') }}
												</button>
												<div class="realtime-box" style="display:flex; align-items:center; gap:8px; flex-wrap:wrap; max-width: 420px; overflow:hidden;">
													<span class="countdown" style="color:#8aa4c4; font-size:12px;">{{ t('下次刷新倒计时：') }}{{ Math.floor((realtimeCountdown||0)/60) }}:{{ ((realtimeCountdown||0)%60).toString().padStart(2,'0') }}</span>
													<div class="marquee" style="flex:1 1 auto; min-width:160px; max-width:420px; overflow:hidden; white-space:nowrap;">
														<div class="marquee-inner">{{ realtimeMessage }}</div>
													</div>
												</div>
											</div>
										</div>
										<div class="list" ref="faultList">
											<div v-if="faultsLoading" class="empty loading">
												<span class="spinner" aria-hidden="true"></span>
												<span class="text">{{ t('故障加载中…') }}</span>
											</div>
											<div v-else-if="displayFaults.length === 0" class="empty">{{ t('暂无故障') }}</div>
											<div v-else>
												<div class="item" v-for="(f, i) in displayFaults" :key="f.name + i"
													:class="{ active: i === selectedFaultIndex }"
													:ref="'faultItem-' + i" @mouseenter="showFaultTooltip(f, $event)"
													@mousemove="moveFaultTooltip($event)" @mouseleave="hideFaultTooltip($event)"
													@click="selectFault(f, i)"
													style="grid-template-columns: 1fr; align-items: flex-start; cursor: pointer; gap:6px;">
													<div class="primary"
														style="justify-content: space-between; width: 100%;">
														<div
															style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
															<span style="font-weight:700;">{{ faultTitle(f) }}</span>
															<span v-if="faultSeverityLabel(f)" class="badge" :class="faultSeverityClass(f)">{{
																faultSeverityLabel(f) }}</span>
														</div>
														<div style="display:flex; gap:6px; align-items:center;">
															<span class="badge err">{{ t('故障') }}</span>
															<button class="inline-btn" style="margin-left:8px;"
																@click.stop="toggleFaultDetail(i)">{{
																selectedFaultIndex===i ? t('收起详情') : t('详情') }}</button>
														</div>
													</div>
													<div class="fault-meta-row">
														<span>{{ t('开始：') }}{{ safeVal(f.start) }}</span>
														<span>{{ t('结束：') }}{{ faultEndText(f) }}</span>
														<span class="pill workorder" v-if="f.workOrder">{{ t('工单') }} {{
															safeVal(f.workOrder) }}</span>
														<span class="pill duration">{{ t('历时') }} {{ liveDuration(f) }}</span>
													</div>
													<div class="fault-meta-row" v-if="f.involvedCable1 || f.involvedCable2 || f.involvedCable3">
														<span v-if="f.involvedCable1" class="distance-chip location-chip">{{ t('故障定位1') }}: {{ f.involvedCable1 }} / {{ f.involvedLanding1 || t('未填站点') }} / {{ f.distance1 || '--' }} km</span>
														<span v-if="f.involvedCable2" class="distance-chip location-chip">{{ t('故障定位2') }}: {{ f.involvedCable2 }} / {{ f.involvedLanding2 || t('未填站点') }} / {{ f.distance2 || '--' }} km</span>
														<span v-if="f.involvedCable3" class="distance-chip location-chip">{{ t('故障定位3') }}: {{ f.involvedCable3 }} / {{ f.involvedLanding3 || t('未填站点') }} / {{ f.distance3 || '--' }} km</span>
													</div>
													<div v-if="isCompactMode && faultPanelExpanded && selectedFaultIndex===i && !faultOverlayMode" class="fault-detail inline">
														<div class="title">
															<span>{{ faultTitle(f) }}</span>
															<div class="chips">
																<span class="badge err">{{ t('故障') }}</span>
																<span v-if="faultSeverityLabel(f)" class="badge" :class="faultSeverityClass(f)">{{ faultSeverityLabel(f) }}</span>
																<span class="pill duration">{{ t('历时') }} {{ liveDuration(f) }}</span>
															</div>
														</div>
														<div class="fault-meta-grid loc-grid">
															<div class="fault-meta-card loc-1">
																<div class="label">{{ t('故障定位1') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(1)">{{ faultEditState.active && faultEditState.index===1 ? t('编辑中') : t('编辑') }}</button></div>
																<div class="value fault-loc-card">
																	<div class="fault-loc-main">
																		<span class="fault-loc-landing">{{ safeVal(f.involvedLanding1) || t('未填站点') }}</span>
																		<span class="fault-loc-distance">{{ safeVal(f.distance1) || '--' }} km</span>
																	</div>
																	<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(f.involvedCable1) || t('未填写') }}</div>
																	<div class="fault-loc-remark" v-if="f.pointRemark1">{{ t('故障点备注1') }}：{{ f.pointRemark1 }}</div>
																</div>
															</div>
															<div class="fault-meta-card loc-2">
																<div class="label">{{ t('故障定位2') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(2)">{{ faultEditState.active && faultEditState.index===2 ? t('编辑中') : t('编辑') }}</button></div>
																<div class="value fault-loc-card">
																	<div class="fault-loc-main">
																		<span class="fault-loc-landing">{{ safeVal(f.involvedLanding2) || t('未填站点') }}</span>
																		<span class="fault-loc-distance">{{ safeVal(f.distance2) || '--' }} km</span>
																	</div>
																	<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(f.involvedCable2) || t('未填写') }}</div>
																	<div class="fault-loc-remark" v-if="f.pointRemark2">{{ t('故障点备注2') }}：{{ f.pointRemark2 }}</div>
																</div>
															</div>
															<div class="fault-meta-card highlight loc-3">
																<div class="label">{{ t('故障定位3') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(3)">{{ faultEditState.active && faultEditState.index===3 ? t('编辑中') : t('编辑') }}</button></div>
																<div class="value fault-loc-card">
																	<div class="fault-loc-main">
																		<span class="fault-loc-landing">{{ safeVal(f.involvedLanding3) || t('未填站点') }}</span>
																		<span class="fault-loc-distance">{{ safeVal(f.distance3) || '--' }} km</span>
																	</div>
																	<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(f.involvedCable3) || t('未填写') }}</div>
																	<div class="fault-loc-remark" v-if="f.pointRemark3">{{ t('故障点备注3') }}：{{ f.pointRemark3 }}</div>
																</div>
															</div>
														</div>
														<div class="fault-edit-overlay" v-if="faultEditState.active" @click.stop>
															<div class="fault-edit-overlay-inner" :style="{ transform: 'translate(' + (faultOverlayState.dx||0) + 'px,' + (faultOverlayState.dy||0) + 'px)', overflow: 'auto' }" :title="t('按住标题可拖动，右下角可拖拉高宽')">
																<div class="overlay-header" @mousedown.stop="startFaultOverlayDrag">
																	<span>{{ t('编辑故障定位') }} {{ faultEditState.index }}</span>
																	<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('关闭') }}</button>
																</div>
																<div class="fault-edit-group compact">
																	<el-select class="fault-edit-select" v-model="faultEditState.cable" filterable clearable :placeholder="t('选择或搜索故障定位海缆')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown" @change="onEditCableChange">
																		<el-option v-for="nm in cableNameOptions" :key="nm" :label="nm" :value="nm"></el-option>
																	</el-select>
																	<el-select class="fault-edit-select" v-model="faultEditState.landing" filterable clearable :placeholder="t('选择或搜索登陆站（需先选海缆）')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown">
																		<el-option v-for="nm in landingOptionsForEdit" :key="nm" :label="nm" :value="nm"></el-option>
																	</el-select>
																	<input class="fault-edit-input readonly" type="text" v-model="faultEditState.distance" :placeholder="t('距离 (km)')" readonly>
																	<input class="fault-edit-input readonly" type="text" v-model="faultEditState.pointCoord" :placeholder="t('故障点经纬度 (Lon,Lat)')" readonly>
																	<textarea class="fault-edit-input fault-remark-input" v-model="faultEditState.remark" :placeholder="t('故障点备注（可拖拽调整高宽）')" @input="autoResizeTextarea"></textarea>
																	<div class="fault-edit-actions">
																		<button class="inline-btn" @click.stop="startFaultPointPick()">{{ t('打点') }}</button>
																		<button class="inline-btn" :disabled="faultEditState.saving" @click.stop="saveFaultEdit()">{{ t('保存') }}</button>
																		<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('取消') }}</button>
																	</div>
																	<span class="meta err" v-if="faultEditState.error" style="color:#ff9f7f;">{{ faultEditState.error }}</span>
																</div>
															</div>
														</div>
														<div class="rows">
															<div class="row"><div class="key">{{ t('涉及海缆') }}</div><div class="val">{{ safeVal(f.cableName || f.name) }}</div></div>
															<div class="row"><div class="key">{{ t('故障描述') }}</div><div class="val">{{ safeVal(f.desc) }}</div></div>
															<div class="row"><div class="key">{{ t('故障原因') }}</div><div class="val">{{ safeVal(f.cause) }}</div></div>
															<div class="row"><div class="key">{{ t('处理进展') }}</div><div class="val">{{ safeVal(f.progress) }}</div></div>
															<div class="row"><div class="key">{{ t('最近一次修改者') }}</div><div class="val">{{ safeVal(f.lastModifier || (f.raw && f.raw['大屏最近一次操作用户'])) }}</div></div>
															<div class="row"><div class="key">{{ t('业务影响') }}</div><div class="val">{{ safeVal(f.impact) }}</div></div>
														</div>
														<div style="display:flex; justify-content:flex-end; gap:10px; margin-top:8px;">
															<button class="inline-btn" @click.stop="expandFaultOverlay()">{{ t('展开到大窗') }}</button>
															<button class="inline-btn" @click.stop="toggleFaultDetail(i)">{{ t('收起') }}</button>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div v-if="isCompactMode && faultPanelExpanded && faultOverlayMode && selectedFault" class="compact-fault-overlay" @click.self="closeFaultOverlay()">
											<div class="fault-detail">
												<button class="close overlay-close" @click.stop="closeFaultOverlay()">×</button>
												<div class="title">
													<span>{{ faultTitle(selectedFault) }}</span>
													<div class="chips">
														<span class="badge err">{{ t('故障') }}</span>
														<span v-if="faultSeverityLabel(selectedFault)" class="badge" :class="faultSeverityClass(selectedFault)">{{ faultSeverityLabel(selectedFault) }}</span>
														<span class="pill duration">{{ t('历时') }} {{ liveDuration(selectedFault) }}</span>
													</div>
												</div>
												<div class="fault-meta-grid loc-grid">
													<div class="fault-meta-card loc-1">
														<div class="label">{{ t('故障定位1') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(1)">{{ faultEditState.active && faultEditState.index===1 ? t('编辑中') : t('编辑') }}</button></div>
														<div class="value fault-loc-card">
															<div class="fault-loc-main">
																<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding1) || t('未填站点') }}</span>
																<span class="fault-loc-distance">{{ safeVal(selectedFault.distance1) || '--' }} km</span>
															</div>
															<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable1) || t('未填写') }}</div>
															<div class="fault-loc-remark" v-if="selectedFault.pointRemark1">{{ t('故障点备注1') }}：{{ selectedFault.pointRemark1 }}</div>
														</div>
													</div>
													<div class="fault-meta-card loc-2">
														<div class="label">{{ t('故障定位2') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(2)">{{ faultEditState.active && faultEditState.index===2 ? t('编辑中') : t('编辑') }}</button></div>
														<div class="value fault-loc-card">
															<div class="fault-loc-main">
																<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding2) || t('未填站点') }}</span>
																<span class="fault-loc-distance">{{ safeVal(selectedFault.distance2) || '--' }} km</span>
															</div>
															<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable2) || t('未填写') }}</div>
															<div class="fault-loc-remark" v-if="selectedFault.pointRemark2">{{ t('故障点备注2') }}：{{ selectedFault.pointRemark2 }}</div>
														</div>
													</div>
													<div class="fault-meta-card highlight loc-3">
														<div class="label">{{ t('故障定位3') }} <button class="fault-loc-label-btn" :title="t('编辑')" @click.stop="startFaultEdit(3)">{{ faultEditState.active && faultEditState.index===3 ? t('编辑中') : t('编辑') }}</button></div>
														<div class="value fault-loc-card">
															<div class="fault-loc-main">
																<span class="fault-loc-landing">{{ safeVal(selectedFault.involvedLanding3) || t('未填站点') }}</span>
																<span class="fault-loc-distance">{{ safeVal(selectedFault.distance3) || '--' }} km</span>
															</div>
															<div class="fault-loc-sub">{{ t('海缆：') }}{{ safeVal(selectedFault.involvedCable3) || t('未填写') }}</div>
															<div class="fault-loc-remark" v-if="selectedFault.pointRemark3">{{ t('故障点备注3') }}：{{ selectedFault.pointRemark3 }}</div>
														</div>
													</div>
												</div>
												<div class="fault-edit-overlay" v-if="faultEditState.active" @click.stop>
													<div class="fault-edit-overlay-inner">
														<div class="overlay-header">
															<span>{{ t('编辑故障定位') }} {{ faultEditState.index }}</span>
															<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('关闭') }}</button>
														</div>
														<div class="fault-edit-group compact">
															<el-select class="fault-edit-select" v-model="faultEditState.cable" filterable clearable :placeholder="t('选择或搜索故障定位海缆')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown" @change="onEditCableChange">
																<el-option v-for="nm in cableNameOptions" :key="nm" :label="nm" :value="nm"></el-option>
															</el-select>
															<el-select class="fault-edit-select" v-model="faultEditState.landing" filterable clearable :placeholder="t('选择或搜索登陆站（需先选海缆）')" :popper-append-to-body="true" popper-class="fault-edit-select-dropdown">
																<el-option v-for="nm in landingOptionsForEdit" :key="nm" :label="nm" :value="nm"></el-option>
															</el-select>
															<input class="fault-edit-input readonly" type="text" v-model="faultEditState.distance" :placeholder="t('距离 (km)')" readonly>
															<input class="fault-edit-input readonly" type="text" v-model="faultEditState.pointCoord" :placeholder="t('故障点经纬度 (Lon,Lat)')" readonly>
															<textarea class="fault-edit-input fault-remark-input" v-model="faultEditState.remark" :placeholder="t('故障点备注（可拖拽调整高宽）')" @input="autoResizeTextarea"></textarea>
															<div class="fault-edit-actions">
																<button class="inline-btn" @click.stop="startFaultPointPick()">{{ t('打点') }}</button>
																<button class="inline-btn" :disabled="faultEditState.saving" @click.stop="saveFaultEdit()">{{ t('保存') }}</button>
																<button class="inline-btn" @click.stop="cancelFaultEdit">{{ t('取消') }}</button>
															</div>
															<span class="meta err" v-if="faultEditState.error" style="color:#ff9f7f;">{{ faultEditState.error }}</span>
														</div>
													</div>
												</div>
												<div class="rows">
													<div class="row">
														<div class="key">{{ t('涉及海缆') }}</div>
														<div class="val">{{ safeVal(selectedFault.cableName || selectedFault.name) }} <button class="inline-btn" @click.stop="copyText(selectedFault.cableName || selectedFault.name || '', t('涉及海缆'))">{{ t('复制') }}</button>
														</div>
													</div>
													<div class="row">
														<div class="key">{{ t('故障描述') }}</div>
														<div class="val">{{ safeVal(selectedFault.desc) }} <button class="inline-btn" @click.stop="copyText(selectedFault.desc || '', t('故障描述'))">{{ t('复制') }}</button>
														</div>
													</div>
													<div class="row">
														<div class="key">{{ t('是否重大') }}</div>
														<div class="val">{{ safeVal(selectedFault.isMajor) }}</div>
													</div>
													<div class="row">
														<div class="key">{{ t('故障原因') }}</div>
														<div class="val">{{ safeVal(selectedFault.cause) }} <button class="inline-btn" @click.stop="copyText(selectedFault.cause || '', t('故障原因'))">{{ t('复制') }}</button></div>
													</div>
													<div class="row">
														<div class="key">{{ t('处理进展') }}</div>
														<div class="val">{{ safeVal(selectedFault.progress) }} <button class="inline-btn" @click.stop="copyText(selectedFault.progress || '', t('处理进展'))">{{ t('复制') }}</button></div>
													</div>
													<div class="row">
														<div class="key">{{ t('最近一次修改者') }}</div>
														<div class="val">{{ safeVal(selectedFault.lastModifier || (selectedFault.raw && selectedFault.raw['大屏最近一次操作用户'])) }} <button class="inline-btn" @click.stop="copyText(selectedFault.lastModifier || (selectedFault.raw && selectedFault.raw['大屏最近一次操作用户']) || '', t('最近一次修改者'))">{{ t('复制') }}</button></div>
													</div>
													<div class="row">
														<div class="key">{{ t('业务影响') }}</div>
														<div class="val">{{ safeVal(selectedFault.impact) }} <button class="inline-btn" @click.stop="copyText(selectedFault.impact || '', t('业务影响'))">{{ t('复制') }}</button></div>
													</div>
													<div class="row">
														<div class="key">{{ t('备注') }}</div>
														<div class="val">{{ safeVal(selectedFault.remark) }} <button class="inline-btn" @click.stop="copyText(selectedFault.remark || '', t('备注'))">{{ t('复制') }}</button></div>
													</div>
													<div class="row" v-if="selectedFault.registrar">
														<div class="key">{{ t('登记人') }}</div>
														<div class="val">{{ safeVal(selectedFault.registrar) }} <button class="inline-btn" @click.stop="copyText(selectedFault.registrar || '', t('登记人'))">{{ t('复制') }}</button></div>
													</div>
													<div class="row" v-if="selectedFault.sameRoute">
														<div class="key">{{ t('同路由海缆段') }}</div>
														<div class="val">{{ safeVal(selectedFault.sameRoute) }} <button class="inline-btn" @click.stop="copyText(selectedFault.sameRoute || '', t('同路由海缆段'))">{{ t('复制') }}</button></div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
				</div>
			</div>
			<!-- 居中详情弹窗 -->
			<div v-if="modal.show" class="modal-overlay" @click.self="closeModal">
				<div class="modal-box">
					<div class="modal-header">
						<div class="title">
							<template v-if="modal.type === 'cable'">
								<span>{{ (cableDetail.line && cableDetail.line.name) || modal.line?.name || t('海缆详情')
									}}</span>
								<span class="pill" v-if="(cableDetail.line?.ownership || modal.line?.ownership)">{{
									t(cableDetail.line?.ownership || modal.line?.ownership) }}</span>
								<div>
									<button class="inline-btn"
										@click.stop="toggleItemLang('cable', (cableDetail.line?.id || modal.line?.id))">{{
										getItemLang('cable', (cableDetail.line?.id || modal.line?.id)) === 'zh' ? '中' :
										'EN' }}</button>
								</div>
							</template>
							<template v-else>
								<span>{{ (landingDetail.lp && landingDetail.lp.name) || modal.lp?.name || t('登陆站详情')
									}}</span>
								<span class="pill" v-if="(landingDetail.lp?.country || modal.lp?.country)">{{
									translateCountryToZh(normalizeText(landingDetail.lp?.country || modal.lp?.country))
									}}</span>
								<div>
									<button class="inline-btn"
										@click.stop="toggleItemLang('landing', (landingDetail.lp?.id || modal.lp?.id))">{{
										getItemLang('landing', (landingDetail.lp?.id || modal.lp?.id)) === 'zh' ? '中' :
										'EN' }}</button>
								</div>
							</template>
						</div>
						<button class="close" @click="closeModal">×</button>
					</div>
					<div class="modal-body">
						<div v-if="modal.type === 'cable'" class="modal-rows">
							<div class="row">
								<div class="key">{{ tWithLang('编号', getItemLang('cable', cableDetail.line?.id || modal.line?.id)) }}</div>
								<div class="val">{{ cableDetail.line?.id || modal.line?.id || '-' }}</div>
							</div>
							<div class="row">
								<div class="key">{{ tWithLang('权益类型', getItemLang('cable', cableDetail.line?.id || modal.line?.id)) }}</div>
									<div class="val">{{ (cableDetail.line?.ownership || modal.line?.ownership) ? t(cableDetail.line?.ownership || modal.line?.ownership) : tWithLang('非权益', getItemLang('cable', cableDetail.line?.id || modal.line?.id)) }}
							</div>
							</div>
							<div class="row">
								<div class="key">{{ tWithLang('局向', getItemLang('cable', cableDetail.line?.id || modal.line?.id)) }}</div>
								<div class="val">{{ displayDirection(cableDetail.line?.direction ||
									modal.line?.direction || cableDetail.detail?.direction) }}</div>
							</div>
							<div class="row">
								<div class="key">{{ tWithLang('洲别', getItemLang('cable', cableDetail.line?.id || modal.line?.id)) }}</div>
								<div class="val">{{ displayContinents(cableDetail.line?.continents ||
									modal.line?.continents || cableDetail.detail?.continents ||
									cableDetail.line?.continent || modal.line?.continent ||
									cableDetail.detail?.continent) || displayMacroRegion(cableDetail.line?.continent ||
									modal.line?.continent || cableDetail.detail?.continent) || '-' }}</div>
							</div>
							<div class="row">
								<div class="key">{{ tWithLang('商用年', getItemLang('cable', cableDetail.line?.id || modal.line?.id)) }}</div>
								<div class="val">{{ cableDetail.detail?.rfs_year || '-' }}</div>
							</div>
							<div class="row" v-if="cableDetail.detail?.length">
								<div class="key">{{ t('长度') }}</div>
								<div class="val">{{ cableDetail.detail.length }}</div>
							</div>
							<div class="row" v-if="cableDetail.detail?.owners || cableDetail.detail?.owner">
								<div class="key">{{ t('运营商') }}</div>
								<div class="val">{{ translateEntities(cableDetail.detail.owners ||
									cableDetail.detail.owner, getItemLang('cable', (cableDetail.line?.id ||
									modal.line?.id))) }}</div>
							</div>
							<div class="row" v-if="cableDetail.detail?.suppliers">
								<div class="key">{{ t('供应商') }}</div>
								<div class="val">{{ translateEntities(cableDetail.detail.suppliers, getItemLang('cable',
									(cableDetail.line?.id || modal.line?.id))) }}</div>
							</div>
							<div class="row" v-if="getCableUrl(cableDetail.line || modal.line)">
								<div class="key">{{ t('官网') }}</div>
								<div class="val"><button class="link-btn"
										@click.stop="openUrl(getCableUrl(cableDetail.line || modal.line))">{{ t('官网') }}</button>
								</div>
							</div>
							<div class="row">
								<div class="key">{{ t('登陆点') }}</div>
								<div class="val">{{ landingCount(cableDetail.detail) }} {{ t('个') }}</div>
							</div>
							<div v-if="landingCount(cableDetail.detail) > 0" class="modal-lines">
								<div class="line" v-for="(lp,i2) in normalizeLandingPoints(cableDetail.detail)"
									:key="lp.id || i2" @click.stop="focusLandingByRef(lp)">
									<span class="name">{{ lp.name }}</span>
									<span class="meta">{{ translateCountryToZh(normalizeText(lp.country || '-'))
										}}</span>
								</div>
							</div>
							<div v-else style="color:#8aa4c4;">{{ t('暂无登陆点信息') }}</div>
						</div>

						<div v-else class="modal-rows">
							<div class="row">
								<div class="key">{{ t('编号') }}</div>
								<div class="val">{{ landingDetail.lp?.id || modal.lp?.id || '-' }}</div>
							</div>
							<div class="row">
								<div class="key">{{ t('权益类型') }}</div>
									<div class="val">{{ (landingDetail.lp?.ownership || modal.lp?.ownership) ? t(landingDetail.lp?.ownership || modal.lp?.ownership) : t('非权益') }}</div>
							</div>
							<div class="row">
								<div class="key">{{ t('是否待定') }}</div>
								<div class="val">{{ (landingDetail.lp?.is_tbd ? t('是') : landingDetail.lp?.is_tbd === false
									? t('否') : (modal.lp?.is_tbd ? t('是') : modal.lp?.is_tbd === false ? t('否') : '-')) }}</div>
							</div>
							<div class="row">
								<div class="key">{{ t('经纬度') }}</div>
								<div class="val">
									<template
										v-if="(landingDetail.lp?.coords && landingDetail.lp.coords.length>=2) || (modal.lp?.coords && modal.lp.coords.length>=2)">
										Lon {{ Number((landingDetail.lp?.coords||modal.lp?.coords)[0]).toFixed(3) }},
										Lat {{ Number((landingDetail.lp?.coords||modal.lp?.coords)[1]).toFixed(3) }}
									</template>
									<template v-else>-</template>
								</div>
							</div>
							<div class="row">
								<div class="key">{{ tWithLang('局向', getItemLang('landing', landingDetail.lp?.id || modal.lp?.id)) }}</div>
								<div class="val">{{ displayDirection(landingDetail.lp?.direction || modal.lp?.direction
									|| landingDetail.detail?.direction) }}</div>
							</div>
							<div class="row">
								<div class="key">{{ tWithLang('洲别', getItemLang('landing', landingDetail.lp?.id || modal.lp?.id)) }}</div>
								<div class="val">{{ displayContinents(landingDetail.lp?.continent || modal.lp?.continent
									|| landingDetail.detail?.continent || landingDetail.lp?.continentMacro ||
									modal.lp?.continentMacro || landingDetail.detail?.continentMacro) ||
									displayMacroRegion(landingDetail.lp?.continent || modal.lp?.continent ||
									landingDetail.detail?.continent || landingDetail.lp?.continentMacro ||
									modal.lp?.continentMacro || landingDetail.detail?.continentMacro) || '-' }}</div>
							</div>
							<div class="row">
								<div class="key">{{ tWithLang('关联海缆', getItemLang('landing', landingDetail.lp?.id || modal.lp?.id)) }}</div>
								<div class="val">{{ landingDetail.detail?.cables?.length || 0 }} {{ unitLabel('条', getItemLang('landing', landingDetail.lp?.id || modal.lp?.id)) }}<span
										v-if="landingDetail.loading">（{{ tWithLang('加载中…', getItemLang('landing', landingDetail.lp?.id || modal.lp?.id)) }}）</span></div>
							</div>
							<div v-if="landingDetail.detail?.cables?.length" class="modal-lines">
								<div class="line" v-for="(cb, idx) in landingDetail.detail.cables" :key="cb.id || idx"
									@click.stop="focusCableByRef(cb)" style="cursor:pointer;">
									<span class="name">{{ cb.name }}</span>
									<span class="meta">商用年 {{ cb.rfs_year || '-' }} <span class="planned"
											v-if="cb.is_planned">规划中</span></span>
								</div>
							</div>
							<div v-else style="color:#8aa4c4;">{{ t('暂无关联海缆') }}</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 所有业务逻辑都在 app.js -->
	<script src="js/app.js"></script>
</body>

</html>
